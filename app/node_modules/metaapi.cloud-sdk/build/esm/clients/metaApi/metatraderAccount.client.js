'use strict';
import MetaApiClient from '../metaApi.client';
import randomstring from 'randomstring';
let MetatraderAccountClient = class MetatraderAccountClient extends MetaApiClient {
    /**
   * Metatrader account replica model
   * @typedef {Object} MetatraderAccountReplicaDto
   * @property {string} _id Unique account replica id
   * @property {State} state Current account replica state
   * @property {number} magic Magic value the trades should be performed using
   * @property {ConnectionStatus} connectionStatus Connection status of the MetaTrader terminal to the application
   * @property {string} quoteStreamingIntervalInSeconds Quote streaming interval in seconds. Set to 0 in order to 
   * receive quotes on each tick. Intervals less than 2.5 seconds are supported only for G2
   * @property {string} [symbol] Any symbol provided by broker (required for G1 only)
   * @property {Reliability} reliability Used to increase the reliability of the account replica. High is a recommended value
   * for production environment
   * @property {Array<string>} tags User-defined account replica tags
   * @property {Object} [metadata] Extra information which can be stored together with your account replica. 
   * Total length of this field after serializing it to JSON is limited to 1024 characters
   * @property {number} resourceSlots Number of resource slots to allocate to account replica. Allocating extra resource slots
   * results in better account performance under load which is useful for some applications. E.g. if you have many
   * accounts copying the same strategy via CooyFactory API, then you can increase resourceSlots to get a lower trade
   * copying latency. Please note that allocating extra resource slots is a paid option. Please note that high
   * reliability accounts use redundant infrastructure, so that each resource slot for a high reliability account
   * is billed as 2 standard resource slots.
   * @property {number} copyFactoryResourceSlots Number of CopyFactory 2 resource slots to allocate to account replica.
   * Allocating extra resource slots results in lower trade copying latency. Please note that allocating extra resource
   * slots is a paid option. Please also note that CopyFactory 2 uses redundant infrastructure so that
   * each CopyFactory resource slot is billed as 2 standard resource slots. You will be billed for CopyFactory 2
   * resource slots only if you have added your account to CopyFactory 2 by specifying copyFactoryRoles field.
   * @property {string} region Region id to deploy account replica at. One of returned by the /users/current/regions endpoint
   * @property {string} createdAt The time account replica was created at, in ISO format
   * @property {MetatraderAccountDto} primaryAccount Primary account
   */ /**
   * MetaTrader account model
   * @typedef {Object} MetatraderAccountDto
   * @property {string} _id Unique account id
   * @property {State} state Current account state
   * @property {number} magic Magic value the trades should be performed using
   * @property {ConnectionStatus} connectionStatus Connection status of the MetaTrader terminal to the application
   * @property {string} quoteStreamingIntervalInSeconds Quote streaming interval in seconds. Set to 0 in order to 
   * receive quotes on each tick. Intervals less than 2.5 seconds are supported only for G2
   * @property {string} [symbol] Any symbol provided by broker (required for G1 only)
   * @property {Reliability} reliability Used to increase the reliability of the account. High is a recommended value
   * for production environment
   * @property {Array<string>} tags User-defined account tags
   * @property {Object} [metadata] Extra information which can be stored together with your account. 
   * Total length of this field after serializing it to JSON is limited to 1024 characters
   * @property {number} resourceSlots Number of resource slots to allocate to account. Allocating extra resource slots
   * results in better account performance under load which is useful for some applications. E.g. if you have many
   * accounts copying the same strategy via CooyFactory API, then you can increase resourceSlots to get a lower trade
   * copying latency. Please note that allocating extra resource slots is a paid option. Please note that high
   * reliability accounts use redundant infrastructure, so that each resource slot for a high reliability account
   * is billed as 2 standard resource slots.
   * @property {number} copyFactoryResourceSlots Number of CopyFactory 2 resource slots to allocate to account.
   * Allocating extra resource slots results in lower trade copying latency. Please note that allocating extra resource
   * slots is a paid option. Please also note that CopyFactory 2 uses redundant infrastructure so that
   * each CopyFactory resource slot is billed as 2 standard resource slots. You will be billed for CopyFactory 2
   * resource slots only if you have added your account to CopyFactory 2 by specifying copyFactoryRoles field.
   * @property {string} region Region id to deploy account at. One of returned by the /users/current/regions endpoint
   * @property {string} createdAt The time account was created at, in ISO format
   * @property {string} name Human-readable account name
   * @property {boolean} manualTrades Flag indicating if trades should be placed as manual trades. Supported on G2 only
   * @property {number} [slippage] Default trade slippage in points. Should be greater or equal to zero. If not
   * specified, system internal setting will be used which we believe is reasonable for most cases
   * @property {string} [provisioningProfileId] Id of the provisioning profile that was used as the basis for 
   * creating this account
   * @property {string} [login] MetaTrader account login
   * @property {string} server MetaTrader server name to connect to 
   * @property {Type} type Account type. Executing accounts as cloud-g2 is faster and cheaper
   * @property {Version} version MetaTrader version
   * @property {number} hash Hash-code of the account
   * @property {string} baseCurrency 3-character ISO currency code of the account base currency.
   * The setting is to be used for copy trading accounts which use national currencies only, such as some Brazilian
   * brokers. You should not alter this setting unless you understand what you are doing.
   * @property {Array<CopyFactoryRoles>} copyFactoryRoles Account roles for CopyFactory2 application
   * @property {boolean} riskManagementApiEnabled Flag indicating that risk management API is enabled on
   * account
   * @property {boolean} metastatsApiEnabled Flag indicating that MetaStats API is enabled on account
   * @property {Array<AccountConnection>} connections Active account connections
   * @property {boolean} primaryReplica Flag indicating that account is primary
   * @property {string} userId User id
   * @property {string} [primaryAccountId] Primary account id. Only replicas can have this field
   * @property {Array<MetatraderAccountReplicaDto>} accountReplicas MetaTrader account replicas
   */ /**
   * MetaTrader account list model
   * @typedef {Object} MetatraderAccountListDto
   * @property {number} count MetaTrader accounts count
   * @property {Array<MetatraderAccountDto>} items MetaTrader accounts list
   */ /**
   * Account connection
   * @typedef {Object} AccountConnection
   * @property {string} region Region the account is connected at
   * @property {string} zone Availability zone the account is connected at
   * @property {string} application Application the account is connected to, one of `MetaApi`, `CopyFactory subscriber`,
   * `CopyFactory provider`, `CopyFactory history import`, `Risk management`
   */ /**
   * MT version
   * @typedef {4 | 5} Version
   */ /**
   * MT platform
   * @typedef {'mt4' | 'mt5'} Platform
   */ /**
   * Account type
   * @typedef {'cloud-g1' | 'cloud-g2'} Type
   */ /**
   * Account state
   * @typedef {'CREATED' | 'DEPLOYING' | 'DEPLOYED' | 'DEPLOY_FAILED' | 'UNDEPLOYING' | 'UNDEPLOYED' |
   * 'UNDEPLOY_FAILED' | 'DELETING' | 'DELETE_FAILED' | 'REDEPLOY_FAILED' | 'DRAFT'} State
   */ /**
   * Account connection status
   * @typedef {'CONNECTED' | 'DISCONNECTED' | 'DISCONNECTED_FROM_BROKER'} ConnectionStatus
   */ /**
   * Account reliability
   * @typedef {'high' | 'regular'} Reliability
   */ /**
   * CopyFactory roles
   * @typedef {'SUBSCRIBER' | 'PROVIDER'} CopyFactoryRoles
   */ /**
   * Sort order
   * @typedef {'asc' | 'desc'} SortOrder
   */ /**
   * Get accounts api version
   * @typedef {'1' | '2'} GetAccountsApiVersion
   */ /**
   * @typedef {Object} AccountsFilter
   * @property {number} [offset] Search offset (defaults to 0) (must be greater or equal to 0)
   * @property {number} [limit] Search limit (defaults to 1000) 
   * (must be greater or equal to 1 and less or equal to 1000)
   * @property {Array<Version> | Version} [version] MT version
   * @property {Array<Type> | Type} [type] Account type
   * @property {Array<State> | State} [state] Account state
   * @property {Array<ConnectionStatus> | ConnectionStatus} [connectionStatus] Connection status
   * @property {string} [query] Searches over _id, name, server and login to match query
   * @property {string} [provisioningProfileId] Provisioning profile id
   * @property {SortOrder} [sortOrder] Sort order for stateChangedAt field, default is no order
   * @property {Array<string> | string} [region] Available region
   * @property {Array<CopyFactoryRoles> | CopyFactoryRoles} [copyFactoryRoles] Account roles for CopyFactory2 API
   */ /**
   * Returns trading accounts belonging to the current user (see https://metaapi.cloud/docs/provisioning/api/account/readAccounts/)
   * Method is accessible only with API access token
   * @param {AccountsFilter} [accountsFilter] optional filter
   * @param {GetAccountsApiVersion} [apiVersion] api version to use
   * @return {Promise<Array<MetatraderAccountDto> | MetatraderAccountListDto>} promise resolving with MetaTrader accounts found
   */ getAccounts(accountsFilter = {}, apiVersion) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('getAccounts');
        }
        const opts = {
            url: `${this._host}/users/current/accounts`,
            method: 'GET',
            params: accountsFilter,
            headers: {
                'auth-token': this._token
            },
            json: true
        };
        if (apiVersion) {
            opts.headers['api-version'] = apiVersion;
        }
        return this._httpClient.request(opts, 'getAccounts');
    }
    /**
   * Returns trading account by id (see https://metaapi.cloud/docs/provisioning/api/account/readAccount/)
   * Method is accessible only with API access token
   * @param {string} id MetaTrader account id
   * @return {Promise<MetatraderAccountDto>} promise resolving with MetaTrader account found
   */ getAccount(id) {
        const opts = {
            url: `${this._host}/users/current/accounts/${id}`,
            method: 'GET',
            headers: {
                'auth-token': this._token
            },
            json: true
        };
        return this._httpClient.request(opts, 'getAccount');
    }
    /**
   * Returns trading account replica by trading account id and replica id (see 
   * https://metaapi.cloud/docs/provisioning/api/accountReplica/readAccountReplica/)
   * Method is accessible only with API access token
   * @param {string} accountId MetaTrader primary account id
   * @param {string} replicaId MetaTrader account replica id
   * @return {Promise<MetatraderAccountReplicaDto>} promise resolving with MetaTrader account replica found
   */ getAccountReplica(accountId, replicaId) {
        const opts = {
            url: `${this._host}/users/current/accounts/${accountId}/replicas/${replicaId}`,
            method: 'GET',
            headers: {
                'auth-token': this._token
            },
            json: true
        };
        return this._httpClient.request(opts, 'getAccountReplica');
    }
    /**
   * Returns replicas for a trading account (see 
   * https://metaapi.cloud/docs/provisioning/api/accountReplica/readAccountReplicas/)
   * Method is accessible only with API access token
   * @param {string} accountId Primary account id
   * @return {Promise<Array<MetatraderAccountReplicaDto>>} promise resolving with MetaTrader account replicas found
   */ getAccountReplicas(accountId) {
        const opts = {
            url: `${this._host}/users/current/accounts/${accountId}/replicas`,
            method: 'GET',
            headers: {
                'auth-token': this._token
            },
            json: true
        };
        return this._httpClient.request(opts, 'getAccountReplicas');
    }
    /**
   * New MetaTrader account model
   * @typedef {Object} NewMetatraderAccountDto
   * @property {string} [symbol] Any MetaTrader symbol your broker provides historical market data for. 
   * This value should be specified for G1 accounts only and only in case your MT account fails to connect to broker.
   * @property {number} magic Magic value the trades should be performed using.
   * When manualTrades field is set to true, magic value must be 0
   * @property {string} [quoteStreamingIntervalInSeconds] Quote streaming interval in seconds. Set to 0 in order to 
   * receive quotes on each tick. Default value is 2.5 seconds. Intervals less than 2.5 seconds are supported only for G2
   * @property {Array<string>} [tags] User-defined account tags
   * @property {Object} [metadata] Extra information which can be stored together with your account. 
   * Total length of this field after serializing it to JSON is limited to 1024 characters
   * @property {Reliability} [reliability] Used to increase the reliability of the account. High is a recommended value 
   * for production environment. Default value is high
   * @property {number} [resourceSlots] Number of resource slots to allocate to account. Allocating extra resource slots
   * results in better account performance under load which is useful for some applications. E.g. if you have many
   * accounts copying the same strategy via CooyFactory API, then you can increase resourceSlots to get a lower trade
   * copying latency. Please note that allocating extra resource slots is a paid option. Please note that high
   * reliability accounts use redundant infrastructure, so that each resource slot for a high reliability account
   * is billed as 2 standard resource slots. Default is 1.
   * @property {number} [copyFactoryResourceSlots] Number of CopyFactory 2 resource slots to allocate to account.
   * Allocating extra resource slots results in lower trade copying latency. Please note that allocating extra resource
   * slots is a paid option. Please also note that CopyFactory 2 uses redundant infrastructure so that
   * each CopyFactory resource slot is billed as 2 standard resource slots. You will be billed for CopyFactory 2
   * resource slots only if you have added your account to CopyFactory 2 by specifying copyFactoryRoles field.
   * Default is 1.
   * @property {string} region Region id to deploy account at. One of returned by the /users/current/regions endpoint
   * @property {string} name Human-readable account name
   * @property {boolean} [manualTrades] Flag indicating if trades should be placed as manual trades.
   * Supported on G2 only. Default is false.
   * @property {number} [slippage] Default trade slippage in points. Should be greater or equal to zero. If not
   * specified, system internal setting will be used which we believe is reasonable for most cases
   * @property {string} [provisioningProfileId] Id of the provisioning profile that was used as the basis for creating 
   * this account. Required for cloud account
   * @property {string} [login] MetaTrader account login. Only digits are allowed
   * @property {string} [password] MetaTrader account password. The password can be either investor password for read-only
   * access or provider password to enable trading features.
   * @property {string} server MetaTrader server name to connect to 
   * @property {Platform} [platform] MetaTrader platform
   * @property {Type} [type] Account type. Executing accounts as cloud-g2 is faster and cheaper. 
   * Default value is cloud-g2
   * @property {string} [baseCurrency] 3-character ISO currency code of the account base currency. Default value is USD.
   * The setting is to be used for copy trading accounts which use national currencies only, such as some Brazilian
   * brokers. You should not alter this setting unless you understand what you are doing.
   * @property {Array<CopyFactoryRoles>} [copyFactoryRoles] Account roles for CopyFactory2 API
   * @property {boolean} [riskManagementApiEnabled] Flag indicating that risk management API should be enabled on
   * account. Default is false
   * @property {boolean} [metastatsApiEnabled] Flag indicating that MetaStats API should be enabled on account. Default is false
   * @property {Array<String>} [keywords] Keywords to be used for broker server search.
   * We recommend to include exact broker company name in this list 
   */ /**
   * MetaTrader account id model
   * @typedef {Object} MetatraderAccountIdDto
   * @property {string} id MetaTrader account unique identifier
   * @property {string} state State of the account. Possible values are 'UNDEPLOYED', 'DEPLOYED', 'DRAFT'
   */ /**
   * Adds a trading account and starts a cloud API server for the trading account (see 
   * https://metaapi.cloud/docs/provisioning/api/account/createAccount/).
   * It can take some time for the API server and trading terminal to start and connect to broker.
   * You can use the `connectionStatus` replica field to monitor the current status of the trading account.
   * Method is accessible only with API access token
   * @param {NewMetatraderAccountDto} account MetaTrader account data
   * @return {Promise<MetatraderAccountIdDto>} promise resolving with an id and state of the MetaTrader account created
   */ createAccount(account) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('createAccount');
        }
        const opts = {
            url: `${this._host}/users/current/accounts`,
            method: 'POST',
            headers: {
                'auth-token': this._token,
                'transaction-id': randomstring.generate(32)
            },
            json: true,
            data: account
        };
        return this._httpClient.request(opts, 'createAccount');
    }
    /**
   * New MetaTrader account replica model
   * @typedef {Object} NewMetaTraderAccountReplicaDto
   * @property {string} [symbol] Any MetaTrader symbol your broker provides historical market data for. 
   * This value should be specified for G1 accounts only and only in case your MT account fails to connect to broker.
   * @property {number} magic Magic value the trades should be performed using.
   * When manualTrades field is set to true, magic value must be 0
   * @property {string} [quoteStreamingIntervalInSeconds] Quote streaming interval in seconds. Set to 0 in order to 
   * receive quotes on each tick. Default value is 2.5 seconds. Intervals less than 2.5 seconds are supported only for G2
   * @property {Array<string>} [tags] User-defined account replica tags
   * @property {Object} [metadata] Extra information which can be stored together with your account replica. 
   * Total length of this field after serializing it to JSON is limited to 1024 characters
   * @property {Reliability} [reliability] Used to increase the reliability of the account replica. High is a recommended value 
   * for production environment. Default value is high
   * @property {number} [resourceSlots] Number of resource slots to allocate to account replica. Allocating extra resource slots
   * results in better account performance under load which is useful for some applications. E.g. if you have many
   * accounts copying the same strategy via CooyFactory API, then you can increase resourceSlots to get a lower trade
   * copying latency. Please note that allocating extra resource slots is a paid option. Please note that high
   * reliability accounts use redundant infrastructure, so that each resource slot for a high reliability account
   * is billed as 2 standard resource slots. Default is 1.
   * @property {number} [copyFactoryResourceSlots] Number of CopyFactory 2 resource slots to allocate to account replica.
   * Allocating extra resource slots results in lower trade copying latency. Please note that allocating extra resource
   * slots is a paid option. Please also note that CopyFactory 2 uses redundant infrastructure so that
   * each CopyFactory resource slot is billed as 2 standard resource slots. You will be billed for CopyFactory 2
   * resource slots only if you have added your account to CopyFactory 2 by specifying copyFactoryRoles field.
   * Default is 1.
   * @property {string} region Region id to deploy account replica at. One of returned by the /users/current/regions endpoint
   */ /**
   * Creates a trading account replica in a region different from trading account region and starts a cloud API server for it
   * (see https://metaapi.cloud/docs/provisioning/api/accountReplica/createAccountReplica/).
   * It can take some time for the API server and trading terminal to start and connect to broker.
   * You can use the `connectionStatus` replica field to monitor the current status of the replica.
   * Method is accessible only with API access token
   * @param {string} accountId primary account id
   * @param {NewMetaTraderAccountReplicaDto} account MetaTrader account data
   * @return {Promise<MetatraderAccountIdDto>} promise resolving with an id and state of the MetaTrader account replica created
   */ createAccountReplica(accountId, account) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('createAccountReplica');
        }
        const opts = {
            url: `${this._host}/users/current/accounts/${accountId}/replicas`,
            method: 'POST',
            headers: {
                'auth-token': this._token,
                'transaction-id': randomstring.generate(32)
            },
            json: true,
            data: account
        };
        return this._httpClient.request(opts, 'createAccountReplica');
    }
    /**
   * Starts API server and trading terminal for trading account.
   * This request will be ignored if the account is already deployed.
   * (see https://metaapi.cloud/docs/provisioning/api/account/deployAccount/)
   * Method is accessible only with API access token
   * @param {string} id MetaTrader account id
   * @return {Promise} promise resolving when MetaTrader account is scheduled for deployment
   */ deployAccount(id) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('deployAccount');
        }
        const opts = {
            url: `${this._host}/users/current/accounts/${id}/deploy`,
            method: 'POST',
            headers: {
                'auth-token': this._token
            },
            json: true
        };
        return this._httpClient.request(opts, 'deployAccount');
    }
    /**
   * Starts API server and trading terminal for trading account replica.
   * This request will be ignored if the replica is already deployed
   * (see https://metaapi.cloud/docs/provisioning/api/accountReplica/deployAccountReplica/)
   * Method is accessible only with API access token
   * @param {string} accountId MetaTrader account id
   * @param {string} replicaId MetaTrader account replica id
   * @return {Promise} promise resolving when MetaTrader account replica is scheduled for deployment
   */ deployAccountReplica(accountId, replicaId) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('deployAccountReplica');
        }
        const opts = {
            url: `${this._host}/users/current/accounts/${accountId}/replicas/${replicaId}/deploy`,
            method: 'POST',
            headers: {
                'auth-token': this._token
            },
            json: true
        };
        return this._httpClient.request(opts, 'deployAccountReplica');
    }
    /**
   * Stops API server and trading terminal for trading account.
   * This request will be ignored if trading account is already undeployed
   * (see https://metaapi.cloud/docs/provisioning/api/account/undeployAccount/)
   * Method is accessible only with API access token
   * @param {string} id MetaTrader account id
   * @return {Promise} promise resolving when MetaTrader account is scheduled for undeployment
   */ undeployAccount(id) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('undeployAccount');
        }
        const opts = {
            url: `${this._host}/users/current/accounts/${id}/undeploy`,
            method: 'POST',
            headers: {
                'auth-token': this._token
            },
            json: true
        };
        return this._httpClient.request(opts, 'undeployAccount');
    }
    /**
   * Stops API server and trading terminal for trading account replica.
   * The request will be ignored if trading account replica is already undeployed
   * (see https://metaapi.cloud/docs/provisioning/api/accountReplica/undeployAccountReplica/)
   * Method is accessible only with API access token
   * @param {string} accountId MetaTrader primary account id
   * @param {string} replicaId MetaTrader account replica id
   * @return {Promise} promise resolving when MetaTrader account replica is scheduled for undeployment
   */ undeployAccountReplica(accountId, replicaId) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('undeployAccountReplica');
        }
        const opts = {
            url: `${this._host}/users/current/accounts/${accountId}/replicas/${replicaId}/undeploy`,
            method: 'POST',
            headers: {
                'auth-token': this._token
            },
            json: true
        };
        return this._httpClient.request(opts, 'undeployAccountReplica');
    }
    /**
   * Redeploys trading account. This is equivalent to undeploy immediately followed by deploy
   * (see https://metaapi.cloud/docs/provisioning/api/account/redeployAccount/)
   * Method is accessible only with API access token
   * @param {string} id MetaTrader account id
   * @return {Promise} promise resolving when MetaTrader account is scheduled for redeployment
   */ redeployAccount(id) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('redeployAccount');
        }
        const opts = {
            url: `${this._host}/users/current/accounts/${id}/redeploy`,
            method: 'POST',
            headers: {
                'auth-token': this._token
            },
            json: true
        };
        return this._httpClient.request(opts, 'redeployAccount');
    }
    /**
   * Redeploys trading account replica. This is equivalent to undeploy immediately followed by deploy.
   * (see https://metaapi.cloud/docs/provisioning/api/account/redeployAccountReplica/)
   * Method is accessible only with API access token
   * @param {string} accountId MetaTrader primary account id
   * @param {string} replicaId MetaTrader account replica id
   * @return {Promise} promise resolving when MetaTrader account replica is scheduled for redeployment
   */ redeployAccountReplica(accountId, replicaId) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('redeployAccountReplica');
        }
        const opts = {
            url: `${this._host}/users/current/accounts/${accountId}/replicas/${replicaId}/redeploy`,
            method: 'POST',
            headers: {
                'auth-token': this._token
            },
            json: true
        };
        return this._httpClient.request(opts, 'redeployAccountReplica');
    }
    /**
   * Removes a trading account and stops the API server serving the account.
   * The account state such as downloaded market data history will be removed as well when you remove the account.
   * (see https://metaapi.cloud/docs/provisioning/api/account/deleteAccount/).
   * Method is accessible only with API access token
   * @param {string} id Id of the account to be deleted
   * @return {Promise} promise resolving when MetaTrader account is scheduled for deletion
   */ deleteAccount(id) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('deleteAccount');
        }
        const opts = {
            url: `${this._host}/users/current/accounts/${id}`,
            method: 'DELETE',
            headers: {
                'auth-token': this._token
            },
            json: true
        };
        return this._httpClient.request(opts, 'deleteAccount');
    }
    /**
   * Removes a trading account replica and stops the API server serving the replica
   * (see https://metaapi.cloud/docs/provisioning/api/account/deleteAccountReplica/).
   * Method is accessible only with API access token
   * @param {string} accountId primary account id
   * @param {string} replicaId Id of the account replica to be deleted
   * @return {Promise} promise resolving when MetaTrader account replica is scheduled for deletion
   */ deleteAccountReplica(accountId, replicaId) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('deleteAccountReplica');
        }
        const opts = {
            url: `${this._host}/users/current/accounts/${accountId}/replicas/${replicaId}`,
            method: 'DELETE',
            headers: {
                'auth-token': this._token
            },
            json: true
        };
        return this._httpClient.request(opts, 'deleteAccountReplica');
    }
    /**
   * Updated MetaTrader account data
   * @typedef {Object} MetatraderAccountUpdateDto
   * @property {string} name Human-readable account name
   * @property {string} [password] MetaTrader account password. The password can be either investor password for read-only
   * access or provider password to enable trading features
   * @property {string} server MetaTrader server name to connect to
   * @property {number} [magic] Magic value the trades should be performed using.
   * When manualTrades field is set to true, magic value must be 0
   * @property {boolean} [manualTrades] Flag indicating if trades should be placed as manual trades. Supported for G2 only.
   * Default is false.
   * @property {number} [slippage] Default trade slippage in points. Should be greater or equal to zero. If not specified,
   * system internal setting will be used which we believe is reasonable for most cases
   * @property {number} [quoteStreamingIntervalInSeconds] Quote streaming interval in seconds. Set to 0 in order to
   * receive quotes on each tick. Intervals less than 2.5 seconds are supported only for G2.
   * Default value is 2.5 seconds
   * @property {Array<string>} [tags] MetaTrader account tags
   * @property {Object} [metadata] extra information which can be stored together with your account
   * @property {number} [resourceSlots] Number of resource slots to allocate to account. Allocating extra resource slots
   * results in better account performance under load which is useful for some applications. E.g. if you have many
   * accounts copying the same strategy via CooyFactory API, then you can increase resourceSlots to get a lower trade
   * copying latency. Please note that allocating extra resource slots is a paid option. Default is 1
   * @property {number} [copyFactoryResourceSlots] Number of CopyFactory 2 resource slots to allocate to account.
   * Allocating extra resource slots results in lower trade copying latency. Please note that allocating extra resource
   * slots is a paid option. Please also note that CopyFactory 2 uses redundant infrastructure so that
   * each CopyFactory resource slot is billed as 2 standard resource slots. You will be billed for CopyFactory 2
   * resource slots only if you have added your account to CopyFactory 2 by specifying copyFactoryRoles field.
   * Default is 1. 
   */ /**
   * Updates trading account. 
   * Please redeploy the trading account in order for updated settings to take effect
   * (see https://metaapi.cloud/docs/provisioning/api/account/updateAccount/).
   * Method is accessible only with API access token
   * @param {string} id MetaTrader account id
   * @param {MetatraderAccountUpdateDto} account updated account information
   * @return {Promise} promise resolving when MetaTrader account is updated
   */ updateAccount(id, account) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('updateAccount');
        }
        const opts = {
            url: `${this._host}/users/current/accounts/${id}`,
            method: 'PUT',
            headers: {
                'auth-token': this._token
            },
            json: true,
            data: account
        };
        return this._httpClient.request(opts, 'updateAccount');
    }
    /**
   * Updated MetaTrader account replica data
   * @typedef {Object} UpdatedMetatraderAccountReplicaDto
   * @property {number} [magic] Magic value the trades should be performed using.
   * When manualTrades field is set to true, magic value must be 0
   * @property {number} [quoteStreamingIntervalInSeconds] Quote streaming interval in seconds. Set to 0 in order to
   * receive quotes on each tick. Default value is 2.5 seconds. Intervals less than 2.5 seconds are supported
   * only for G2
   * @property {Array<string>} [tags] MetaTrader account tags
   * @property {Object} [metadata] extra information which can be stored together with your account
   * @property {number} [resourceSlots] Number of resource slots to allocate to account. Allocating extra resource slots
   * results in better account performance under load which is useful for some applications. E.g. if you have many
   * accounts copying the same strategy via CooyFactory API, then you can increase resourceSlots to get a lower trade
   * copying latency. Please note that allocating extra resource slots is a paid option. Default is 1
   * @property {number} [copyFactoryResourceSlots] Number of CopyFactory 2 resource slots to allocate to account.
   * Allocating extra resource slots results in lower trade copying latency. Please note that allocating extra resource
   * slots is a paid option. Please also note that CopyFactory 2 uses redundant infrastructure so that
   * each CopyFactory resource slot is billed as 2 standard resource slots. You will be billed for CopyFactory 2
   * resource slots only if you have added your account to CopyFactory 2 by specifying copyFactoryRoles field.
   * Default is 1.
   */ /**
   * Updates trading account replica (see
   * https://metaapi.cloud/docs/provisioning/api/account/updateAccountReplica/).
   * Method is accessible only with API access token
   * @param {string} accountId MetaTrader primary account id
   * @param {string} replicaId MetaTrader account replica id
   * @param {UpdatedMetatraderAccountReplicaDto} metatraderAccount updated account replica information
   * @return {Promise} promise resolving when MetaTrader account replica is updated
   */ updateAccountReplica(accountId, replicaId, metatraderAccount) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('updateAccountReplica');
        }
        const opts = {
            url: `${this._host}/users/current/accounts/${accountId}/replicas/${replicaId}`,
            method: 'PUT',
            headers: {
                'auth-token': this._token
            },
            json: true,
            data: metatraderAccount
        };
        return this._httpClient.request(opts, 'updateAccountReplica');
    }
    /**
   * Increases trading account reliability in order to increase the expected account uptime.
   * The account will be temporary stopped to perform this action.
   * Note that increasing reliability is a paid option (see
   * https://metaapi.cloud/docs/provisioning/api/account/increaseReliability/).
   * Method is accessible only with API access token
   * @param {string} id MetaTrader account id
   * @return {Promise} promise resolving when MetaTrader account reliability is increased
   */ increaseReliability(id) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('increaseReliability');
        }
        const opts = {
            url: `${this._host}/users/current/accounts/${id}/increase-reliability`,
            method: 'POST',
            headers: {
                'auth-token': this._token
            },
            json: true
        };
        return this._httpClient.request(opts, 'increaseReliability');
    }
    /**
   * Enables risk management API for trading account.
   * The account will be temporary stopped to perform this action.
   * Note that risk management API is a paid option (see
   * https://metaapi.cloud/docs/provisioning/api/account/enableRiskManagementApi/).
   * Method is accessible only with API access token
   * @param {string} id MetaTrader account id
   * @return {Promise} promise resolving when account risk management is enabled
   */ enableRiskManagementApi(id) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('enableRiskManagementApi');
        }
        const opts = {
            url: `${this._host}/users/current/accounts/${id}/enable-risk-management-api`,
            method: 'POST',
            headers: {
                'auth-token': this._token
            },
            json: true
        };
        return this._httpClient.request(opts, 'enableRiskManagementApi');
    }
    /**
   * Enables MetaStats API for trading account.
   * The account will be temporary stopped to perform this action.
   * Note that this is a paid option (see
   * https://metaapi.cloud/docs/provisioning/api/account/enableMetaStatsApi/).
   * Method is accessible only with API access token
   * @param {string} id MetaTrader account id
   * @return {Promise} promise resolving when account MetaStats API is enabled
   */ enableMetaStatsApi(id) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('enableMetaStatsApi');
        }
        const opts = {
            url: `${this._host}/users/current/accounts/${id}/enable-metastats-api`,
            method: 'POST',
            headers: {
                'auth-token': this._token
            },
            json: true
        };
        return this._httpClient.request(opts, 'enableMetaStatsApi');
    }
    /**
   * Configuration link
   * @typedef {Object} ConfigurationLink
   * @property {string} configurationLink Secure link to allow end user to configure account directly
   */ /**
   * Generates trading account configuration link by account id.
   * (see https://metaapi.cloud/docs/provisioning/api/account/createConfigurationLink/)
   * This link can be used by the end user to enter trading account login and password or change the password.
   * Method is accessible only with API access token
   * @param {string} accountId Trading account id
   * @param {number} [ttlInDays] Lifetime of the link in days. Default is 7.
   * @return {Promise<ConfigurationLink>} promise resolving with configuration link
   */ createConfigurationLink(accountId, ttlInDays) {
        if (this._isNotJwtToken()) {
            return this._handleNoAccessError('createConfigurationLink');
        }
        const opts = {
            url: `${this._host}/users/current/accounts/${accountId}/configuration-link`,
            method: 'PUT',
            headers: {
                'auth-token': this._token
            },
            params: {
                ttlInDays: ttlInDays
            },
            json: true
        };
        return this._httpClient.request(opts, 'createConfigurationLink');
    }
};
/**
 * metaapi.cloud MetaTrader account API client (see https://metaapi.cloud/docs/provisioning/)
 */ export { MetatraderAccountClient as default };

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjxhbm9uPiJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmltcG9ydCBNZXRhQXBpQ2xpZW50IGZyb20gJy4uL21ldGFBcGkuY2xpZW50JztcbmltcG9ydCByYW5kb21zdHJpbmcgZnJvbSAncmFuZG9tc3RyaW5nJztcblxuLyoqXG4gKiBtZXRhYXBpLmNsb3VkIE1ldGFUcmFkZXIgYWNjb3VudCBBUEkgY2xpZW50IChzZWUgaHR0cHM6Ly9tZXRhYXBpLmNsb3VkL2RvY3MvcHJvdmlzaW9uaW5nLylcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWV0YXRyYWRlckFjY291bnRDbGllbnQgZXh0ZW5kcyBNZXRhQXBpQ2xpZW50IHtcblxuICAvKipcbiAgICogTWV0YXRyYWRlciBhY2NvdW50IHJlcGxpY2EgbW9kZWxcbiAgICogQHR5cGVkZWYge09iamVjdH0gTWV0YXRyYWRlckFjY291bnRSZXBsaWNhRHRvXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBfaWQgVW5pcXVlIGFjY291bnQgcmVwbGljYSBpZFxuICAgKiBAcHJvcGVydHkge1N0YXRlfSBzdGF0ZSBDdXJyZW50IGFjY291bnQgcmVwbGljYSBzdGF0ZVxuICAgKiBAcHJvcGVydHkge251bWJlcn0gbWFnaWMgTWFnaWMgdmFsdWUgdGhlIHRyYWRlcyBzaG91bGQgYmUgcGVyZm9ybWVkIHVzaW5nXG4gICAqIEBwcm9wZXJ0eSB7Q29ubmVjdGlvblN0YXR1c30gY29ubmVjdGlvblN0YXR1cyBDb25uZWN0aW9uIHN0YXR1cyBvZiB0aGUgTWV0YVRyYWRlciB0ZXJtaW5hbCB0byB0aGUgYXBwbGljYXRpb25cbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IHF1b3RlU3RyZWFtaW5nSW50ZXJ2YWxJblNlY29uZHMgUXVvdGUgc3RyZWFtaW5nIGludGVydmFsIGluIHNlY29uZHMuIFNldCB0byAwIGluIG9yZGVyIHRvIFxuICAgKiByZWNlaXZlIHF1b3RlcyBvbiBlYWNoIHRpY2suIEludGVydmFscyBsZXNzIHRoYW4gMi41IHNlY29uZHMgYXJlIHN1cHBvcnRlZCBvbmx5IGZvciBHMlxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gW3N5bWJvbF0gQW55IHN5bWJvbCBwcm92aWRlZCBieSBicm9rZXIgKHJlcXVpcmVkIGZvciBHMSBvbmx5KVxuICAgKiBAcHJvcGVydHkge1JlbGlhYmlsaXR5fSByZWxpYWJpbGl0eSBVc2VkIHRvIGluY3JlYXNlIHRoZSByZWxpYWJpbGl0eSBvZiB0aGUgYWNjb3VudCByZXBsaWNhLiBIaWdoIGlzIGEgcmVjb21tZW5kZWQgdmFsdWVcbiAgICogZm9yIHByb2R1Y3Rpb24gZW52aXJvbm1lbnRcbiAgICogQHByb3BlcnR5IHtBcnJheTxzdHJpbmc+fSB0YWdzIFVzZXItZGVmaW5lZCBhY2NvdW50IHJlcGxpY2EgdGFnc1xuICAgKiBAcHJvcGVydHkge09iamVjdH0gW21ldGFkYXRhXSBFeHRyYSBpbmZvcm1hdGlvbiB3aGljaCBjYW4gYmUgc3RvcmVkIHRvZ2V0aGVyIHdpdGggeW91ciBhY2NvdW50IHJlcGxpY2EuIFxuICAgKiBUb3RhbCBsZW5ndGggb2YgdGhpcyBmaWVsZCBhZnRlciBzZXJpYWxpemluZyBpdCB0byBKU09OIGlzIGxpbWl0ZWQgdG8gMTAyNCBjaGFyYWN0ZXJzXG4gICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSByZXNvdXJjZVNsb3RzIE51bWJlciBvZiByZXNvdXJjZSBzbG90cyB0byBhbGxvY2F0ZSB0byBhY2NvdW50IHJlcGxpY2EuIEFsbG9jYXRpbmcgZXh0cmEgcmVzb3VyY2Ugc2xvdHNcbiAgICogcmVzdWx0cyBpbiBiZXR0ZXIgYWNjb3VudCBwZXJmb3JtYW5jZSB1bmRlciBsb2FkIHdoaWNoIGlzIHVzZWZ1bCBmb3Igc29tZSBhcHBsaWNhdGlvbnMuIEUuZy4gaWYgeW91IGhhdmUgbWFueVxuICAgKiBhY2NvdW50cyBjb3B5aW5nIHRoZSBzYW1lIHN0cmF0ZWd5IHZpYSBDb295RmFjdG9yeSBBUEksIHRoZW4geW91IGNhbiBpbmNyZWFzZSByZXNvdXJjZVNsb3RzIHRvIGdldCBhIGxvd2VyIHRyYWRlXG4gICAqIGNvcHlpbmcgbGF0ZW5jeS4gUGxlYXNlIG5vdGUgdGhhdCBhbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlIHNsb3RzIGlzIGEgcGFpZCBvcHRpb24uIFBsZWFzZSBub3RlIHRoYXQgaGlnaFxuICAgKiByZWxpYWJpbGl0eSBhY2NvdW50cyB1c2UgcmVkdW5kYW50IGluZnJhc3RydWN0dXJlLCBzbyB0aGF0IGVhY2ggcmVzb3VyY2Ugc2xvdCBmb3IgYSBoaWdoIHJlbGlhYmlsaXR5IGFjY291bnRcbiAgICogaXMgYmlsbGVkIGFzIDIgc3RhbmRhcmQgcmVzb3VyY2Ugc2xvdHMuXG4gICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBjb3B5RmFjdG9yeVJlc291cmNlU2xvdHMgTnVtYmVyIG9mIENvcHlGYWN0b3J5IDIgcmVzb3VyY2Ugc2xvdHMgdG8gYWxsb2NhdGUgdG8gYWNjb3VudCByZXBsaWNhLlxuICAgKiBBbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlIHNsb3RzIHJlc3VsdHMgaW4gbG93ZXIgdHJhZGUgY29weWluZyBsYXRlbmN5LiBQbGVhc2Ugbm90ZSB0aGF0IGFsbG9jYXRpbmcgZXh0cmEgcmVzb3VyY2VcbiAgICogc2xvdHMgaXMgYSBwYWlkIG9wdGlvbi4gUGxlYXNlIGFsc28gbm90ZSB0aGF0IENvcHlGYWN0b3J5IDIgdXNlcyByZWR1bmRhbnQgaW5mcmFzdHJ1Y3R1cmUgc28gdGhhdFxuICAgKiBlYWNoIENvcHlGYWN0b3J5IHJlc291cmNlIHNsb3QgaXMgYmlsbGVkIGFzIDIgc3RhbmRhcmQgcmVzb3VyY2Ugc2xvdHMuIFlvdSB3aWxsIGJlIGJpbGxlZCBmb3IgQ29weUZhY3RvcnkgMlxuICAgKiByZXNvdXJjZSBzbG90cyBvbmx5IGlmIHlvdSBoYXZlIGFkZGVkIHlvdXIgYWNjb3VudCB0byBDb3B5RmFjdG9yeSAyIGJ5IHNwZWNpZnlpbmcgY29weUZhY3RvcnlSb2xlcyBmaWVsZC5cbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IHJlZ2lvbiBSZWdpb24gaWQgdG8gZGVwbG95IGFjY291bnQgcmVwbGljYSBhdC4gT25lIG9mIHJldHVybmVkIGJ5IHRoZSAvdXNlcnMvY3VycmVudC9yZWdpb25zIGVuZHBvaW50XG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBjcmVhdGVkQXQgVGhlIHRpbWUgYWNjb3VudCByZXBsaWNhIHdhcyBjcmVhdGVkIGF0LCBpbiBJU08gZm9ybWF0XG4gICAqIEBwcm9wZXJ0eSB7TWV0YXRyYWRlckFjY291bnREdG99IHByaW1hcnlBY2NvdW50IFByaW1hcnkgYWNjb3VudFxuICAgKi9cblxuICAvKipcbiAgICogTWV0YVRyYWRlciBhY2NvdW50IG1vZGVsXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IE1ldGF0cmFkZXJBY2NvdW50RHRvXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBfaWQgVW5pcXVlIGFjY291bnQgaWRcbiAgICogQHByb3BlcnR5IHtTdGF0ZX0gc3RhdGUgQ3VycmVudCBhY2NvdW50IHN0YXRlXG4gICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBtYWdpYyBNYWdpYyB2YWx1ZSB0aGUgdHJhZGVzIHNob3VsZCBiZSBwZXJmb3JtZWQgdXNpbmdcbiAgICogQHByb3BlcnR5IHtDb25uZWN0aW9uU3RhdHVzfSBjb25uZWN0aW9uU3RhdHVzIENvbm5lY3Rpb24gc3RhdHVzIG9mIHRoZSBNZXRhVHJhZGVyIHRlcm1pbmFsIHRvIHRoZSBhcHBsaWNhdGlvblxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gcXVvdGVTdHJlYW1pbmdJbnRlcnZhbEluU2Vjb25kcyBRdW90ZSBzdHJlYW1pbmcgaW50ZXJ2YWwgaW4gc2Vjb25kcy4gU2V0IHRvIDAgaW4gb3JkZXIgdG8gXG4gICAqIHJlY2VpdmUgcXVvdGVzIG9uIGVhY2ggdGljay4gSW50ZXJ2YWxzIGxlc3MgdGhhbiAyLjUgc2Vjb25kcyBhcmUgc3VwcG9ydGVkIG9ubHkgZm9yIEcyXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbc3ltYm9sXSBBbnkgc3ltYm9sIHByb3ZpZGVkIGJ5IGJyb2tlciAocmVxdWlyZWQgZm9yIEcxIG9ubHkpXG4gICAqIEBwcm9wZXJ0eSB7UmVsaWFiaWxpdHl9IHJlbGlhYmlsaXR5IFVzZWQgdG8gaW5jcmVhc2UgdGhlIHJlbGlhYmlsaXR5IG9mIHRoZSBhY2NvdW50LiBIaWdoIGlzIGEgcmVjb21tZW5kZWQgdmFsdWVcbiAgICogZm9yIHByb2R1Y3Rpb24gZW52aXJvbm1lbnRcbiAgICogQHByb3BlcnR5IHtBcnJheTxzdHJpbmc+fSB0YWdzIFVzZXItZGVmaW5lZCBhY2NvdW50IHRhZ3NcbiAgICogQHByb3BlcnR5IHtPYmplY3R9IFttZXRhZGF0YV0gRXh0cmEgaW5mb3JtYXRpb24gd2hpY2ggY2FuIGJlIHN0b3JlZCB0b2dldGhlciB3aXRoIHlvdXIgYWNjb3VudC4gXG4gICAqIFRvdGFsIGxlbmd0aCBvZiB0aGlzIGZpZWxkIGFmdGVyIHNlcmlhbGl6aW5nIGl0IHRvIEpTT04gaXMgbGltaXRlZCB0byAxMDI0IGNoYXJhY3RlcnNcbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IHJlc291cmNlU2xvdHMgTnVtYmVyIG9mIHJlc291cmNlIHNsb3RzIHRvIGFsbG9jYXRlIHRvIGFjY291bnQuIEFsbG9jYXRpbmcgZXh0cmEgcmVzb3VyY2Ugc2xvdHNcbiAgICogcmVzdWx0cyBpbiBiZXR0ZXIgYWNjb3VudCBwZXJmb3JtYW5jZSB1bmRlciBsb2FkIHdoaWNoIGlzIHVzZWZ1bCBmb3Igc29tZSBhcHBsaWNhdGlvbnMuIEUuZy4gaWYgeW91IGhhdmUgbWFueVxuICAgKiBhY2NvdW50cyBjb3B5aW5nIHRoZSBzYW1lIHN0cmF0ZWd5IHZpYSBDb295RmFjdG9yeSBBUEksIHRoZW4geW91IGNhbiBpbmNyZWFzZSByZXNvdXJjZVNsb3RzIHRvIGdldCBhIGxvd2VyIHRyYWRlXG4gICAqIGNvcHlpbmcgbGF0ZW5jeS4gUGxlYXNlIG5vdGUgdGhhdCBhbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlIHNsb3RzIGlzIGEgcGFpZCBvcHRpb24uIFBsZWFzZSBub3RlIHRoYXQgaGlnaFxuICAgKiByZWxpYWJpbGl0eSBhY2NvdW50cyB1c2UgcmVkdW5kYW50IGluZnJhc3RydWN0dXJlLCBzbyB0aGF0IGVhY2ggcmVzb3VyY2Ugc2xvdCBmb3IgYSBoaWdoIHJlbGlhYmlsaXR5IGFjY291bnRcbiAgICogaXMgYmlsbGVkIGFzIDIgc3RhbmRhcmQgcmVzb3VyY2Ugc2xvdHMuXG4gICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBjb3B5RmFjdG9yeVJlc291cmNlU2xvdHMgTnVtYmVyIG9mIENvcHlGYWN0b3J5IDIgcmVzb3VyY2Ugc2xvdHMgdG8gYWxsb2NhdGUgdG8gYWNjb3VudC5cbiAgICogQWxsb2NhdGluZyBleHRyYSByZXNvdXJjZSBzbG90cyByZXN1bHRzIGluIGxvd2VyIHRyYWRlIGNvcHlpbmcgbGF0ZW5jeS4gUGxlYXNlIG5vdGUgdGhhdCBhbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlXG4gICAqIHNsb3RzIGlzIGEgcGFpZCBvcHRpb24uIFBsZWFzZSBhbHNvIG5vdGUgdGhhdCBDb3B5RmFjdG9yeSAyIHVzZXMgcmVkdW5kYW50IGluZnJhc3RydWN0dXJlIHNvIHRoYXRcbiAgICogZWFjaCBDb3B5RmFjdG9yeSByZXNvdXJjZSBzbG90IGlzIGJpbGxlZCBhcyAyIHN0YW5kYXJkIHJlc291cmNlIHNsb3RzLiBZb3Ugd2lsbCBiZSBiaWxsZWQgZm9yIENvcHlGYWN0b3J5IDJcbiAgICogcmVzb3VyY2Ugc2xvdHMgb25seSBpZiB5b3UgaGF2ZSBhZGRlZCB5b3VyIGFjY291bnQgdG8gQ29weUZhY3RvcnkgMiBieSBzcGVjaWZ5aW5nIGNvcHlGYWN0b3J5Um9sZXMgZmllbGQuXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSByZWdpb24gUmVnaW9uIGlkIHRvIGRlcGxveSBhY2NvdW50IGF0LiBPbmUgb2YgcmV0dXJuZWQgYnkgdGhlIC91c2Vycy9jdXJyZW50L3JlZ2lvbnMgZW5kcG9pbnRcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IGNyZWF0ZWRBdCBUaGUgdGltZSBhY2NvdW50IHdhcyBjcmVhdGVkIGF0LCBpbiBJU08gZm9ybWF0XG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBuYW1lIEh1bWFuLXJlYWRhYmxlIGFjY291bnQgbmFtZVxuICAgKiBAcHJvcGVydHkge2Jvb2xlYW59IG1hbnVhbFRyYWRlcyBGbGFnIGluZGljYXRpbmcgaWYgdHJhZGVzIHNob3VsZCBiZSBwbGFjZWQgYXMgbWFudWFsIHRyYWRlcy4gU3VwcG9ydGVkIG9uIEcyIG9ubHlcbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IFtzbGlwcGFnZV0gRGVmYXVsdCB0cmFkZSBzbGlwcGFnZSBpbiBwb2ludHMuIFNob3VsZCBiZSBncmVhdGVyIG9yIGVxdWFsIHRvIHplcm8uIElmIG5vdFxuICAgKiBzcGVjaWZpZWQsIHN5c3RlbSBpbnRlcm5hbCBzZXR0aW5nIHdpbGwgYmUgdXNlZCB3aGljaCB3ZSBiZWxpZXZlIGlzIHJlYXNvbmFibGUgZm9yIG1vc3QgY2FzZXNcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IFtwcm92aXNpb25pbmdQcm9maWxlSWRdIElkIG9mIHRoZSBwcm92aXNpb25pbmcgcHJvZmlsZSB0aGF0IHdhcyB1c2VkIGFzIHRoZSBiYXNpcyBmb3IgXG4gICAqIGNyZWF0aW5nIHRoaXMgYWNjb3VudFxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gW2xvZ2luXSBNZXRhVHJhZGVyIGFjY291bnQgbG9naW5cbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IHNlcnZlciBNZXRhVHJhZGVyIHNlcnZlciBuYW1lIHRvIGNvbm5lY3QgdG8gXG4gICAqIEBwcm9wZXJ0eSB7VHlwZX0gdHlwZSBBY2NvdW50IHR5cGUuIEV4ZWN1dGluZyBhY2NvdW50cyBhcyBjbG91ZC1nMiBpcyBmYXN0ZXIgYW5kIGNoZWFwZXJcbiAgICogQHByb3BlcnR5IHtWZXJzaW9ufSB2ZXJzaW9uIE1ldGFUcmFkZXIgdmVyc2lvblxuICAgKiBAcHJvcGVydHkge251bWJlcn0gaGFzaCBIYXNoLWNvZGUgb2YgdGhlIGFjY291bnRcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IGJhc2VDdXJyZW5jeSAzLWNoYXJhY3RlciBJU08gY3VycmVuY3kgY29kZSBvZiB0aGUgYWNjb3VudCBiYXNlIGN1cnJlbmN5LlxuICAgKiBUaGUgc2V0dGluZyBpcyB0byBiZSB1c2VkIGZvciBjb3B5IHRyYWRpbmcgYWNjb3VudHMgd2hpY2ggdXNlIG5hdGlvbmFsIGN1cnJlbmNpZXMgb25seSwgc3VjaCBhcyBzb21lIEJyYXppbGlhblxuICAgKiBicm9rZXJzLiBZb3Ugc2hvdWxkIG5vdCBhbHRlciB0aGlzIHNldHRpbmcgdW5sZXNzIHlvdSB1bmRlcnN0YW5kIHdoYXQgeW91IGFyZSBkb2luZy5cbiAgICogQHByb3BlcnR5IHtBcnJheTxDb3B5RmFjdG9yeVJvbGVzPn0gY29weUZhY3RvcnlSb2xlcyBBY2NvdW50IHJvbGVzIGZvciBDb3B5RmFjdG9yeTIgYXBwbGljYXRpb25cbiAgICogQHByb3BlcnR5IHtib29sZWFufSByaXNrTWFuYWdlbWVudEFwaUVuYWJsZWQgRmxhZyBpbmRpY2F0aW5nIHRoYXQgcmlzayBtYW5hZ2VtZW50IEFQSSBpcyBlbmFibGVkIG9uXG4gICAqIGFjY291bnRcbiAgICogQHByb3BlcnR5IHtib29sZWFufSBtZXRhc3RhdHNBcGlFbmFibGVkIEZsYWcgaW5kaWNhdGluZyB0aGF0IE1ldGFTdGF0cyBBUEkgaXMgZW5hYmxlZCBvbiBhY2NvdW50XG4gICAqIEBwcm9wZXJ0eSB7QXJyYXk8QWNjb3VudENvbm5lY3Rpb24+fSBjb25uZWN0aW9ucyBBY3RpdmUgYWNjb3VudCBjb25uZWN0aW9uc1xuICAgKiBAcHJvcGVydHkge2Jvb2xlYW59IHByaW1hcnlSZXBsaWNhIEZsYWcgaW5kaWNhdGluZyB0aGF0IGFjY291bnQgaXMgcHJpbWFyeVxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gdXNlcklkIFVzZXIgaWRcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IFtwcmltYXJ5QWNjb3VudElkXSBQcmltYXJ5IGFjY291bnQgaWQuIE9ubHkgcmVwbGljYXMgY2FuIGhhdmUgdGhpcyBmaWVsZFxuICAgKiBAcHJvcGVydHkge0FycmF5PE1ldGF0cmFkZXJBY2NvdW50UmVwbGljYUR0bz59IGFjY291bnRSZXBsaWNhcyBNZXRhVHJhZGVyIGFjY291bnQgcmVwbGljYXNcbiAgICovXG5cblxuICAvKipcbiAgICogTWV0YVRyYWRlciBhY2NvdW50IGxpc3QgbW9kZWxcbiAgICogQHR5cGVkZWYge09iamVjdH0gTWV0YXRyYWRlckFjY291bnRMaXN0RHRvXG4gICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBjb3VudCBNZXRhVHJhZGVyIGFjY291bnRzIGNvdW50XG4gICAqIEBwcm9wZXJ0eSB7QXJyYXk8TWV0YXRyYWRlckFjY291bnREdG8+fSBpdGVtcyBNZXRhVHJhZGVyIGFjY291bnRzIGxpc3RcbiAgICovXG5cbiAgLyoqXG4gICAqIEFjY291bnQgY29ubmVjdGlvblxuICAgKiBAdHlwZWRlZiB7T2JqZWN0fSBBY2NvdW50Q29ubmVjdGlvblxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gcmVnaW9uIFJlZ2lvbiB0aGUgYWNjb3VudCBpcyBjb25uZWN0ZWQgYXRcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IHpvbmUgQXZhaWxhYmlsaXR5IHpvbmUgdGhlIGFjY291bnQgaXMgY29ubmVjdGVkIGF0XG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBhcHBsaWNhdGlvbiBBcHBsaWNhdGlvbiB0aGUgYWNjb3VudCBpcyBjb25uZWN0ZWQgdG8sIG9uZSBvZiBgTWV0YUFwaWAsIGBDb3B5RmFjdG9yeSBzdWJzY3JpYmVyYCxcbiAgICogYENvcHlGYWN0b3J5IHByb3ZpZGVyYCwgYENvcHlGYWN0b3J5IGhpc3RvcnkgaW1wb3J0YCwgYFJpc2sgbWFuYWdlbWVudGBcbiAgICovXG5cbiAgLyoqXG4gICAqIE1UIHZlcnNpb25cbiAgICogQHR5cGVkZWYgezQgfCA1fSBWZXJzaW9uXG4gICAqL1xuXG4gIC8qKlxuICAgKiBNVCBwbGF0Zm9ybVxuICAgKiBAdHlwZWRlZiB7J210NCcgfCAnbXQ1J30gUGxhdGZvcm1cbiAgICovXG5cbiAgLyoqXG4gICAqIEFjY291bnQgdHlwZVxuICAgKiBAdHlwZWRlZiB7J2Nsb3VkLWcxJyB8ICdjbG91ZC1nMid9IFR5cGVcbiAgICovXG5cbiAgLyoqXG4gICAqIEFjY291bnQgc3RhdGVcbiAgICogQHR5cGVkZWYgeydDUkVBVEVEJyB8ICdERVBMT1lJTkcnIHwgJ0RFUExPWUVEJyB8ICdERVBMT1lfRkFJTEVEJyB8ICdVTkRFUExPWUlORycgfCAnVU5ERVBMT1lFRCcgfFxuICAgKiAnVU5ERVBMT1lfRkFJTEVEJyB8ICdERUxFVElORycgfCAnREVMRVRFX0ZBSUxFRCcgfCAnUkVERVBMT1lfRkFJTEVEJyB8ICdEUkFGVCd9IFN0YXRlXG4gICAqL1xuXG4gIC8qKlxuICAgKiBBY2NvdW50IGNvbm5lY3Rpb24gc3RhdHVzXG4gICAqIEB0eXBlZGVmIHsnQ09OTkVDVEVEJyB8ICdESVNDT05ORUNURUQnIHwgJ0RJU0NPTk5FQ1RFRF9GUk9NX0JST0tFUid9IENvbm5lY3Rpb25TdGF0dXNcbiAgICovXG5cbiAgLyoqXG4gICAqIEFjY291bnQgcmVsaWFiaWxpdHlcbiAgICogQHR5cGVkZWYgeydoaWdoJyB8ICdyZWd1bGFyJ30gUmVsaWFiaWxpdHlcbiAgICovXG5cbiAgLyoqXG4gICAqIENvcHlGYWN0b3J5IHJvbGVzXG4gICAqIEB0eXBlZGVmIHsnU1VCU0NSSUJFUicgfCAnUFJPVklERVInfSBDb3B5RmFjdG9yeVJvbGVzXG4gICAqL1xuXG4gIC8qKlxuICAgKiBTb3J0IG9yZGVyXG4gICAqIEB0eXBlZGVmIHsnYXNjJyB8ICdkZXNjJ30gU29ydE9yZGVyXG4gICAqL1xuXG4gIC8qKlxuICAgKiBHZXQgYWNjb3VudHMgYXBpIHZlcnNpb25cbiAgICogQHR5cGVkZWYgeycxJyB8ICcyJ30gR2V0QWNjb3VudHNBcGlWZXJzaW9uXG4gICAqL1xuXG4gIC8qKlxuICAgKiBAdHlwZWRlZiB7T2JqZWN0fSBBY2NvdW50c0ZpbHRlclxuICAgKiBAcHJvcGVydHkge251bWJlcn0gW29mZnNldF0gU2VhcmNoIG9mZnNldCAoZGVmYXVsdHMgdG8gMCkgKG11c3QgYmUgZ3JlYXRlciBvciBlcXVhbCB0byAwKVxuICAgKiBAcHJvcGVydHkge251bWJlcn0gW2xpbWl0XSBTZWFyY2ggbGltaXQgKGRlZmF1bHRzIHRvIDEwMDApIFxuICAgKiAobXVzdCBiZSBncmVhdGVyIG9yIGVxdWFsIHRvIDEgYW5kIGxlc3Mgb3IgZXF1YWwgdG8gMTAwMClcbiAgICogQHByb3BlcnR5IHtBcnJheTxWZXJzaW9uPiB8IFZlcnNpb259IFt2ZXJzaW9uXSBNVCB2ZXJzaW9uXG4gICAqIEBwcm9wZXJ0eSB7QXJyYXk8VHlwZT4gfCBUeXBlfSBbdHlwZV0gQWNjb3VudCB0eXBlXG4gICAqIEBwcm9wZXJ0eSB7QXJyYXk8U3RhdGU+IHwgU3RhdGV9IFtzdGF0ZV0gQWNjb3VudCBzdGF0ZVxuICAgKiBAcHJvcGVydHkge0FycmF5PENvbm5lY3Rpb25TdGF0dXM+IHwgQ29ubmVjdGlvblN0YXR1c30gW2Nvbm5lY3Rpb25TdGF0dXNdIENvbm5lY3Rpb24gc3RhdHVzXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbcXVlcnldIFNlYXJjaGVzIG92ZXIgX2lkLCBuYW1lLCBzZXJ2ZXIgYW5kIGxvZ2luIHRvIG1hdGNoIHF1ZXJ5XG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbcHJvdmlzaW9uaW5nUHJvZmlsZUlkXSBQcm92aXNpb25pbmcgcHJvZmlsZSBpZFxuICAgKiBAcHJvcGVydHkge1NvcnRPcmRlcn0gW3NvcnRPcmRlcl0gU29ydCBvcmRlciBmb3Igc3RhdGVDaGFuZ2VkQXQgZmllbGQsIGRlZmF1bHQgaXMgbm8gb3JkZXJcbiAgICogQHByb3BlcnR5IHtBcnJheTxzdHJpbmc+IHwgc3RyaW5nfSBbcmVnaW9uXSBBdmFpbGFibGUgcmVnaW9uXG4gICAqIEBwcm9wZXJ0eSB7QXJyYXk8Q29weUZhY3RvcnlSb2xlcz4gfCBDb3B5RmFjdG9yeVJvbGVzfSBbY29weUZhY3RvcnlSb2xlc10gQWNjb3VudCByb2xlcyBmb3IgQ29weUZhY3RvcnkyIEFQSVxuICAgKi9cblxuICAvKipcbiAgICogUmV0dXJucyB0cmFkaW5nIGFjY291bnRzIGJlbG9uZ2luZyB0byB0aGUgY3VycmVudCB1c2VyIChzZWUgaHR0cHM6Ly9tZXRhYXBpLmNsb3VkL2RvY3MvcHJvdmlzaW9uaW5nL2FwaS9hY2NvdW50L3JlYWRBY2NvdW50cy8pXG4gICAqIE1ldGhvZCBpcyBhY2Nlc3NpYmxlIG9ubHkgd2l0aCBBUEkgYWNjZXNzIHRva2VuXG4gICAqIEBwYXJhbSB7QWNjb3VudHNGaWx0ZXJ9IFthY2NvdW50c0ZpbHRlcl0gb3B0aW9uYWwgZmlsdGVyXG4gICAqIEBwYXJhbSB7R2V0QWNjb3VudHNBcGlWZXJzaW9ufSBbYXBpVmVyc2lvbl0gYXBpIHZlcnNpb24gdG8gdXNlXG4gICAqIEByZXR1cm4ge1Byb21pc2U8QXJyYXk8TWV0YXRyYWRlckFjY291bnREdG8+IHwgTWV0YXRyYWRlckFjY291bnRMaXN0RHRvPn0gcHJvbWlzZSByZXNvbHZpbmcgd2l0aCBNZXRhVHJhZGVyIGFjY291bnRzIGZvdW5kXG4gICAqL1xuICBnZXRBY2NvdW50cyhhY2NvdW50c0ZpbHRlciA9IHt9LCBhcGlWZXJzaW9uKSB7XG4gICAgaWYgKHRoaXMuX2lzTm90Snd0VG9rZW4oKSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZU5vQWNjZXNzRXJyb3IoJ2dldEFjY291bnRzJyk7XG4gICAgfVxuICAgIGNvbnN0IG9wdHMgPSB7XG4gICAgICB1cmw6IGAke3RoaXMuX2hvc3R9L3VzZXJzL2N1cnJlbnQvYWNjb3VudHNgLFxuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIHBhcmFtczogYWNjb3VudHNGaWx0ZXIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdhdXRoLXRva2VuJzogdGhpcy5fdG9rZW4sXG4gICAgICB9LFxuICAgICAganNvbjogdHJ1ZVxuICAgIH07XG4gICAgaWYgKGFwaVZlcnNpb24pIHtcbiAgICAgIG9wdHMuaGVhZGVyc1snYXBpLXZlcnNpb24nXSA9IGFwaVZlcnNpb247XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9odHRwQ2xpZW50LnJlcXVlc3Qob3B0cywgJ2dldEFjY291bnRzJyk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0cmFkaW5nIGFjY291bnQgYnkgaWQgKHNlZSBodHRwczovL21ldGFhcGkuY2xvdWQvZG9jcy9wcm92aXNpb25pbmcvYXBpL2FjY291bnQvcmVhZEFjY291bnQvKVxuICAgKiBNZXRob2QgaXMgYWNjZXNzaWJsZSBvbmx5IHdpdGggQVBJIGFjY2VzcyB0b2tlblxuICAgKiBAcGFyYW0ge3N0cmluZ30gaWQgTWV0YVRyYWRlciBhY2NvdW50IGlkXG4gICAqIEByZXR1cm4ge1Byb21pc2U8TWV0YXRyYWRlckFjY291bnREdG8+fSBwcm9taXNlIHJlc29sdmluZyB3aXRoIE1ldGFUcmFkZXIgYWNjb3VudCBmb3VuZFxuICAgKi9cbiAgZ2V0QWNjb3VudChpZCkge1xuICAgIGNvbnN0IG9wdHMgPSB7XG4gICAgICB1cmw6IGAke3RoaXMuX2hvc3R9L3VzZXJzL2N1cnJlbnQvYWNjb3VudHMvJHtpZH1gLFxuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgfSxcbiAgICAgIGpzb246IHRydWVcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLl9odHRwQ2xpZW50LnJlcXVlc3Qob3B0cywgJ2dldEFjY291bnQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRyYWRpbmcgYWNjb3VudCByZXBsaWNhIGJ5IHRyYWRpbmcgYWNjb3VudCBpZCBhbmQgcmVwbGljYSBpZCAoc2VlIFxuICAgKiBodHRwczovL21ldGFhcGkuY2xvdWQvZG9jcy9wcm92aXNpb25pbmcvYXBpL2FjY291bnRSZXBsaWNhL3JlYWRBY2NvdW50UmVwbGljYS8pXG4gICAqIE1ldGhvZCBpcyBhY2Nlc3NpYmxlIG9ubHkgd2l0aCBBUEkgYWNjZXNzIHRva2VuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBhY2NvdW50SWQgTWV0YVRyYWRlciBwcmltYXJ5IGFjY291bnQgaWRcbiAgICogQHBhcmFtIHtzdHJpbmd9IHJlcGxpY2FJZCBNZXRhVHJhZGVyIGFjY291bnQgcmVwbGljYSBpZFxuICAgKiBAcmV0dXJuIHtQcm9taXNlPE1ldGF0cmFkZXJBY2NvdW50UmVwbGljYUR0bz59IHByb21pc2UgcmVzb2x2aW5nIHdpdGggTWV0YVRyYWRlciBhY2NvdW50IHJlcGxpY2EgZm91bmRcbiAgICovXG4gIGdldEFjY291bnRSZXBsaWNhKGFjY291bnRJZCwgcmVwbGljYUlkKSB7XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIHVybDogYCR7dGhpcy5faG9zdH0vdXNlcnMvY3VycmVudC9hY2NvdW50cy8ke2FjY291bnRJZH0vcmVwbGljYXMvJHtyZXBsaWNhSWR9YCxcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdhdXRoLXRva2VuJzogdGhpcy5fdG9rZW5cbiAgICAgIH0sXG4gICAgICBqc29uOiB0cnVlXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5faHR0cENsaWVudC5yZXF1ZXN0KG9wdHMsICdnZXRBY2NvdW50UmVwbGljYScpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgcmVwbGljYXMgZm9yIGEgdHJhZGluZyBhY2NvdW50IChzZWUgXG4gICAqIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy9hcGkvYWNjb3VudFJlcGxpY2EvcmVhZEFjY291bnRSZXBsaWNhcy8pXG4gICAqIE1ldGhvZCBpcyBhY2Nlc3NpYmxlIG9ubHkgd2l0aCBBUEkgYWNjZXNzIHRva2VuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBhY2NvdW50SWQgUHJpbWFyeSBhY2NvdW50IGlkXG4gICAqIEByZXR1cm4ge1Byb21pc2U8QXJyYXk8TWV0YXRyYWRlckFjY291bnRSZXBsaWNhRHRvPj59IHByb21pc2UgcmVzb2x2aW5nIHdpdGggTWV0YVRyYWRlciBhY2NvdW50IHJlcGxpY2FzIGZvdW5kXG4gICAqL1xuICBnZXRBY2NvdW50UmVwbGljYXMoYWNjb3VudElkKSB7XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIHVybDogYCR7dGhpcy5faG9zdH0vdXNlcnMvY3VycmVudC9hY2NvdW50cy8ke2FjY291bnRJZH0vcmVwbGljYXNgLFxuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgfSxcbiAgICAgIGpzb246IHRydWVcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLl9odHRwQ2xpZW50LnJlcXVlc3Qob3B0cywgJ2dldEFjY291bnRSZXBsaWNhcycpO1xuICB9XG5cbiAgLyoqXG4gICAqIE5ldyBNZXRhVHJhZGVyIGFjY291bnQgbW9kZWxcbiAgICogQHR5cGVkZWYge09iamVjdH0gTmV3TWV0YXRyYWRlckFjY291bnREdG9cbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IFtzeW1ib2xdIEFueSBNZXRhVHJhZGVyIHN5bWJvbCB5b3VyIGJyb2tlciBwcm92aWRlcyBoaXN0b3JpY2FsIG1hcmtldCBkYXRhIGZvci4gXG4gICAqIFRoaXMgdmFsdWUgc2hvdWxkIGJlIHNwZWNpZmllZCBmb3IgRzEgYWNjb3VudHMgb25seSBhbmQgb25seSBpbiBjYXNlIHlvdXIgTVQgYWNjb3VudCBmYWlscyB0byBjb25uZWN0IHRvIGJyb2tlci5cbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IG1hZ2ljIE1hZ2ljIHZhbHVlIHRoZSB0cmFkZXMgc2hvdWxkIGJlIHBlcmZvcm1lZCB1c2luZy5cbiAgICogV2hlbiBtYW51YWxUcmFkZXMgZmllbGQgaXMgc2V0IHRvIHRydWUsIG1hZ2ljIHZhbHVlIG11c3QgYmUgMFxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gW3F1b3RlU3RyZWFtaW5nSW50ZXJ2YWxJblNlY29uZHNdIFF1b3RlIHN0cmVhbWluZyBpbnRlcnZhbCBpbiBzZWNvbmRzLiBTZXQgdG8gMCBpbiBvcmRlciB0byBcbiAgICogcmVjZWl2ZSBxdW90ZXMgb24gZWFjaCB0aWNrLiBEZWZhdWx0IHZhbHVlIGlzIDIuNSBzZWNvbmRzLiBJbnRlcnZhbHMgbGVzcyB0aGFuIDIuNSBzZWNvbmRzIGFyZSBzdXBwb3J0ZWQgb25seSBmb3IgRzJcbiAgICogQHByb3BlcnR5IHtBcnJheTxzdHJpbmc+fSBbdGFnc10gVXNlci1kZWZpbmVkIGFjY291bnQgdGFnc1xuICAgKiBAcHJvcGVydHkge09iamVjdH0gW21ldGFkYXRhXSBFeHRyYSBpbmZvcm1hdGlvbiB3aGljaCBjYW4gYmUgc3RvcmVkIHRvZ2V0aGVyIHdpdGggeW91ciBhY2NvdW50LiBcbiAgICogVG90YWwgbGVuZ3RoIG9mIHRoaXMgZmllbGQgYWZ0ZXIgc2VyaWFsaXppbmcgaXQgdG8gSlNPTiBpcyBsaW1pdGVkIHRvIDEwMjQgY2hhcmFjdGVyc1xuICAgKiBAcHJvcGVydHkge1JlbGlhYmlsaXR5fSBbcmVsaWFiaWxpdHldIFVzZWQgdG8gaW5jcmVhc2UgdGhlIHJlbGlhYmlsaXR5IG9mIHRoZSBhY2NvdW50LiBIaWdoIGlzIGEgcmVjb21tZW5kZWQgdmFsdWUgXG4gICAqIGZvciBwcm9kdWN0aW9uIGVudmlyb25tZW50LiBEZWZhdWx0IHZhbHVlIGlzIGhpZ2hcbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IFtyZXNvdXJjZVNsb3RzXSBOdW1iZXIgb2YgcmVzb3VyY2Ugc2xvdHMgdG8gYWxsb2NhdGUgdG8gYWNjb3VudC4gQWxsb2NhdGluZyBleHRyYSByZXNvdXJjZSBzbG90c1xuICAgKiByZXN1bHRzIGluIGJldHRlciBhY2NvdW50IHBlcmZvcm1hbmNlIHVuZGVyIGxvYWQgd2hpY2ggaXMgdXNlZnVsIGZvciBzb21lIGFwcGxpY2F0aW9ucy4gRS5nLiBpZiB5b3UgaGF2ZSBtYW55XG4gICAqIGFjY291bnRzIGNvcHlpbmcgdGhlIHNhbWUgc3RyYXRlZ3kgdmlhIENvb3lGYWN0b3J5IEFQSSwgdGhlbiB5b3UgY2FuIGluY3JlYXNlIHJlc291cmNlU2xvdHMgdG8gZ2V0IGEgbG93ZXIgdHJhZGVcbiAgICogY29weWluZyBsYXRlbmN5LiBQbGVhc2Ugbm90ZSB0aGF0IGFsbG9jYXRpbmcgZXh0cmEgcmVzb3VyY2Ugc2xvdHMgaXMgYSBwYWlkIG9wdGlvbi4gUGxlYXNlIG5vdGUgdGhhdCBoaWdoXG4gICAqIHJlbGlhYmlsaXR5IGFjY291bnRzIHVzZSByZWR1bmRhbnQgaW5mcmFzdHJ1Y3R1cmUsIHNvIHRoYXQgZWFjaCByZXNvdXJjZSBzbG90IGZvciBhIGhpZ2ggcmVsaWFiaWxpdHkgYWNjb3VudFxuICAgKiBpcyBiaWxsZWQgYXMgMiBzdGFuZGFyZCByZXNvdXJjZSBzbG90cy4gRGVmYXVsdCBpcyAxLlxuICAgKiBAcHJvcGVydHkge251bWJlcn0gW2NvcHlGYWN0b3J5UmVzb3VyY2VTbG90c10gTnVtYmVyIG9mIENvcHlGYWN0b3J5IDIgcmVzb3VyY2Ugc2xvdHMgdG8gYWxsb2NhdGUgdG8gYWNjb3VudC5cbiAgICogQWxsb2NhdGluZyBleHRyYSByZXNvdXJjZSBzbG90cyByZXN1bHRzIGluIGxvd2VyIHRyYWRlIGNvcHlpbmcgbGF0ZW5jeS4gUGxlYXNlIG5vdGUgdGhhdCBhbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlXG4gICAqIHNsb3RzIGlzIGEgcGFpZCBvcHRpb24uIFBsZWFzZSBhbHNvIG5vdGUgdGhhdCBDb3B5RmFjdG9yeSAyIHVzZXMgcmVkdW5kYW50IGluZnJhc3RydWN0dXJlIHNvIHRoYXRcbiAgICogZWFjaCBDb3B5RmFjdG9yeSByZXNvdXJjZSBzbG90IGlzIGJpbGxlZCBhcyAyIHN0YW5kYXJkIHJlc291cmNlIHNsb3RzLiBZb3Ugd2lsbCBiZSBiaWxsZWQgZm9yIENvcHlGYWN0b3J5IDJcbiAgICogcmVzb3VyY2Ugc2xvdHMgb25seSBpZiB5b3UgaGF2ZSBhZGRlZCB5b3VyIGFjY291bnQgdG8gQ29weUZhY3RvcnkgMiBieSBzcGVjaWZ5aW5nIGNvcHlGYWN0b3J5Um9sZXMgZmllbGQuXG4gICAqIERlZmF1bHQgaXMgMS5cbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IHJlZ2lvbiBSZWdpb24gaWQgdG8gZGVwbG95IGFjY291bnQgYXQuIE9uZSBvZiByZXR1cm5lZCBieSB0aGUgL3VzZXJzL2N1cnJlbnQvcmVnaW9ucyBlbmRwb2ludFxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSBIdW1hbi1yZWFkYWJsZSBhY2NvdW50IG5hbWVcbiAgICogQHByb3BlcnR5IHtib29sZWFufSBbbWFudWFsVHJhZGVzXSBGbGFnIGluZGljYXRpbmcgaWYgdHJhZGVzIHNob3VsZCBiZSBwbGFjZWQgYXMgbWFudWFsIHRyYWRlcy5cbiAgICogU3VwcG9ydGVkIG9uIEcyIG9ubHkuIERlZmF1bHQgaXMgZmFsc2UuXG4gICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbc2xpcHBhZ2VdIERlZmF1bHQgdHJhZGUgc2xpcHBhZ2UgaW4gcG9pbnRzLiBTaG91bGQgYmUgZ3JlYXRlciBvciBlcXVhbCB0byB6ZXJvLiBJZiBub3RcbiAgICogc3BlY2lmaWVkLCBzeXN0ZW0gaW50ZXJuYWwgc2V0dGluZyB3aWxsIGJlIHVzZWQgd2hpY2ggd2UgYmVsaWV2ZSBpcyByZWFzb25hYmxlIGZvciBtb3N0IGNhc2VzXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbcHJvdmlzaW9uaW5nUHJvZmlsZUlkXSBJZCBvZiB0aGUgcHJvdmlzaW9uaW5nIHByb2ZpbGUgdGhhdCB3YXMgdXNlZCBhcyB0aGUgYmFzaXMgZm9yIGNyZWF0aW5nIFxuICAgKiB0aGlzIGFjY291bnQuIFJlcXVpcmVkIGZvciBjbG91ZCBhY2NvdW50XG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbbG9naW5dIE1ldGFUcmFkZXIgYWNjb3VudCBsb2dpbi4gT25seSBkaWdpdHMgYXJlIGFsbG93ZWRcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IFtwYXNzd29yZF0gTWV0YVRyYWRlciBhY2NvdW50IHBhc3N3b3JkLiBUaGUgcGFzc3dvcmQgY2FuIGJlIGVpdGhlciBpbnZlc3RvciBwYXNzd29yZCBmb3IgcmVhZC1vbmx5XG4gICAqIGFjY2VzcyBvciBwcm92aWRlciBwYXNzd29yZCB0byBlbmFibGUgdHJhZGluZyBmZWF0dXJlcy5cbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IHNlcnZlciBNZXRhVHJhZGVyIHNlcnZlciBuYW1lIHRvIGNvbm5lY3QgdG8gXG4gICAqIEBwcm9wZXJ0eSB7UGxhdGZvcm19IFtwbGF0Zm9ybV0gTWV0YVRyYWRlciBwbGF0Zm9ybVxuICAgKiBAcHJvcGVydHkge1R5cGV9IFt0eXBlXSBBY2NvdW50IHR5cGUuIEV4ZWN1dGluZyBhY2NvdW50cyBhcyBjbG91ZC1nMiBpcyBmYXN0ZXIgYW5kIGNoZWFwZXIuIFxuICAgKiBEZWZhdWx0IHZhbHVlIGlzIGNsb3VkLWcyXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbYmFzZUN1cnJlbmN5XSAzLWNoYXJhY3RlciBJU08gY3VycmVuY3kgY29kZSBvZiB0aGUgYWNjb3VudCBiYXNlIGN1cnJlbmN5LiBEZWZhdWx0IHZhbHVlIGlzIFVTRC5cbiAgICogVGhlIHNldHRpbmcgaXMgdG8gYmUgdXNlZCBmb3IgY29weSB0cmFkaW5nIGFjY291bnRzIHdoaWNoIHVzZSBuYXRpb25hbCBjdXJyZW5jaWVzIG9ubHksIHN1Y2ggYXMgc29tZSBCcmF6aWxpYW5cbiAgICogYnJva2Vycy4gWW91IHNob3VsZCBub3QgYWx0ZXIgdGhpcyBzZXR0aW5nIHVubGVzcyB5b3UgdW5kZXJzdGFuZCB3aGF0IHlvdSBhcmUgZG9pbmcuXG4gICAqIEBwcm9wZXJ0eSB7QXJyYXk8Q29weUZhY3RvcnlSb2xlcz59IFtjb3B5RmFjdG9yeVJvbGVzXSBBY2NvdW50IHJvbGVzIGZvciBDb3B5RmFjdG9yeTIgQVBJXG4gICAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gW3Jpc2tNYW5hZ2VtZW50QXBpRW5hYmxlZF0gRmxhZyBpbmRpY2F0aW5nIHRoYXQgcmlzayBtYW5hZ2VtZW50IEFQSSBzaG91bGQgYmUgZW5hYmxlZCBvblxuICAgKiBhY2NvdW50LiBEZWZhdWx0IGlzIGZhbHNlXG4gICAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gW21ldGFzdGF0c0FwaUVuYWJsZWRdIEZsYWcgaW5kaWNhdGluZyB0aGF0IE1ldGFTdGF0cyBBUEkgc2hvdWxkIGJlIGVuYWJsZWQgb24gYWNjb3VudC4gRGVmYXVsdCBpcyBmYWxzZVxuICAgKiBAcHJvcGVydHkge0FycmF5PFN0cmluZz59IFtrZXl3b3Jkc10gS2V5d29yZHMgdG8gYmUgdXNlZCBmb3IgYnJva2VyIHNlcnZlciBzZWFyY2guXG4gICAqIFdlIHJlY29tbWVuZCB0byBpbmNsdWRlIGV4YWN0IGJyb2tlciBjb21wYW55IG5hbWUgaW4gdGhpcyBsaXN0IFxuICAgKi9cblxuICAvKipcbiAgICogTWV0YVRyYWRlciBhY2NvdW50IGlkIG1vZGVsXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IE1ldGF0cmFkZXJBY2NvdW50SWREdG9cbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IGlkIE1ldGFUcmFkZXIgYWNjb3VudCB1bmlxdWUgaWRlbnRpZmllclxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gc3RhdGUgU3RhdGUgb2YgdGhlIGFjY291bnQuIFBvc3NpYmxlIHZhbHVlcyBhcmUgJ1VOREVQTE9ZRUQnLCAnREVQTE9ZRUQnLCAnRFJBRlQnXG4gICAqL1xuXG4gIC8qKlxuICAgKiBBZGRzIGEgdHJhZGluZyBhY2NvdW50IGFuZCBzdGFydHMgYSBjbG91ZCBBUEkgc2VydmVyIGZvciB0aGUgdHJhZGluZyBhY2NvdW50IChzZWUgXG4gICAqIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy9hcGkvYWNjb3VudC9jcmVhdGVBY2NvdW50LykuXG4gICAqIEl0IGNhbiB0YWtlIHNvbWUgdGltZSBmb3IgdGhlIEFQSSBzZXJ2ZXIgYW5kIHRyYWRpbmcgdGVybWluYWwgdG8gc3RhcnQgYW5kIGNvbm5lY3QgdG8gYnJva2VyLlxuICAgKiBZb3UgY2FuIHVzZSB0aGUgYGNvbm5lY3Rpb25TdGF0dXNgIHJlcGxpY2EgZmllbGQgdG8gbW9uaXRvciB0aGUgY3VycmVudCBzdGF0dXMgb2YgdGhlIHRyYWRpbmcgYWNjb3VudC5cbiAgICogTWV0aG9kIGlzIGFjY2Vzc2libGUgb25seSB3aXRoIEFQSSBhY2Nlc3MgdG9rZW5cbiAgICogQHBhcmFtIHtOZXdNZXRhdHJhZGVyQWNjb3VudER0b30gYWNjb3VudCBNZXRhVHJhZGVyIGFjY291bnQgZGF0YVxuICAgKiBAcmV0dXJuIHtQcm9taXNlPE1ldGF0cmFkZXJBY2NvdW50SWREdG8+fSBwcm9taXNlIHJlc29sdmluZyB3aXRoIGFuIGlkIGFuZCBzdGF0ZSBvZiB0aGUgTWV0YVRyYWRlciBhY2NvdW50IGNyZWF0ZWRcbiAgICovXG4gIGNyZWF0ZUFjY291bnQoYWNjb3VudCkge1xuICAgIGlmICh0aGlzLl9pc05vdEp3dFRva2VuKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVOb0FjY2Vzc0Vycm9yKCdjcmVhdGVBY2NvdW50Jyk7XG4gICAgfVxuICAgIGNvbnN0IG9wdHMgPSB7XG4gICAgICB1cmw6IGAke3RoaXMuX2hvc3R9L3VzZXJzL2N1cnJlbnQvYWNjb3VudHNgLFxuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdhdXRoLXRva2VuJzogdGhpcy5fdG9rZW4sXG4gICAgICAgICd0cmFuc2FjdGlvbi1pZCc6IHJhbmRvbXN0cmluZy5nZW5lcmF0ZSgzMilcbiAgICAgIH0sXG4gICAgICBqc29uOiB0cnVlLFxuICAgICAgZGF0YTogYWNjb3VudFxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuX2h0dHBDbGllbnQucmVxdWVzdChvcHRzLCAnY3JlYXRlQWNjb3VudCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIE5ldyBNZXRhVHJhZGVyIGFjY291bnQgcmVwbGljYSBtb2RlbFxuICAgKiBAdHlwZWRlZiB7T2JqZWN0fSBOZXdNZXRhVHJhZGVyQWNjb3VudFJlcGxpY2FEdG9cbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IFtzeW1ib2xdIEFueSBNZXRhVHJhZGVyIHN5bWJvbCB5b3VyIGJyb2tlciBwcm92aWRlcyBoaXN0b3JpY2FsIG1hcmtldCBkYXRhIGZvci4gXG4gICAqIFRoaXMgdmFsdWUgc2hvdWxkIGJlIHNwZWNpZmllZCBmb3IgRzEgYWNjb3VudHMgb25seSBhbmQgb25seSBpbiBjYXNlIHlvdXIgTVQgYWNjb3VudCBmYWlscyB0byBjb25uZWN0IHRvIGJyb2tlci5cbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IG1hZ2ljIE1hZ2ljIHZhbHVlIHRoZSB0cmFkZXMgc2hvdWxkIGJlIHBlcmZvcm1lZCB1c2luZy5cbiAgICogV2hlbiBtYW51YWxUcmFkZXMgZmllbGQgaXMgc2V0IHRvIHRydWUsIG1hZ2ljIHZhbHVlIG11c3QgYmUgMFxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gW3F1b3RlU3RyZWFtaW5nSW50ZXJ2YWxJblNlY29uZHNdIFF1b3RlIHN0cmVhbWluZyBpbnRlcnZhbCBpbiBzZWNvbmRzLiBTZXQgdG8gMCBpbiBvcmRlciB0byBcbiAgICogcmVjZWl2ZSBxdW90ZXMgb24gZWFjaCB0aWNrLiBEZWZhdWx0IHZhbHVlIGlzIDIuNSBzZWNvbmRzLiBJbnRlcnZhbHMgbGVzcyB0aGFuIDIuNSBzZWNvbmRzIGFyZSBzdXBwb3J0ZWQgb25seSBmb3IgRzJcbiAgICogQHByb3BlcnR5IHtBcnJheTxzdHJpbmc+fSBbdGFnc10gVXNlci1kZWZpbmVkIGFjY291bnQgcmVwbGljYSB0YWdzXG4gICAqIEBwcm9wZXJ0eSB7T2JqZWN0fSBbbWV0YWRhdGFdIEV4dHJhIGluZm9ybWF0aW9uIHdoaWNoIGNhbiBiZSBzdG9yZWQgdG9nZXRoZXIgd2l0aCB5b3VyIGFjY291bnQgcmVwbGljYS4gXG4gICAqIFRvdGFsIGxlbmd0aCBvZiB0aGlzIGZpZWxkIGFmdGVyIHNlcmlhbGl6aW5nIGl0IHRvIEpTT04gaXMgbGltaXRlZCB0byAxMDI0IGNoYXJhY3RlcnNcbiAgICogQHByb3BlcnR5IHtSZWxpYWJpbGl0eX0gW3JlbGlhYmlsaXR5XSBVc2VkIHRvIGluY3JlYXNlIHRoZSByZWxpYWJpbGl0eSBvZiB0aGUgYWNjb3VudCByZXBsaWNhLiBIaWdoIGlzIGEgcmVjb21tZW5kZWQgdmFsdWUgXG4gICAqIGZvciBwcm9kdWN0aW9uIGVudmlyb25tZW50LiBEZWZhdWx0IHZhbHVlIGlzIGhpZ2hcbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IFtyZXNvdXJjZVNsb3RzXSBOdW1iZXIgb2YgcmVzb3VyY2Ugc2xvdHMgdG8gYWxsb2NhdGUgdG8gYWNjb3VudCByZXBsaWNhLiBBbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlIHNsb3RzXG4gICAqIHJlc3VsdHMgaW4gYmV0dGVyIGFjY291bnQgcGVyZm9ybWFuY2UgdW5kZXIgbG9hZCB3aGljaCBpcyB1c2VmdWwgZm9yIHNvbWUgYXBwbGljYXRpb25zLiBFLmcuIGlmIHlvdSBoYXZlIG1hbnlcbiAgICogYWNjb3VudHMgY29weWluZyB0aGUgc2FtZSBzdHJhdGVneSB2aWEgQ29veUZhY3RvcnkgQVBJLCB0aGVuIHlvdSBjYW4gaW5jcmVhc2UgcmVzb3VyY2VTbG90cyB0byBnZXQgYSBsb3dlciB0cmFkZVxuICAgKiBjb3B5aW5nIGxhdGVuY3kuIFBsZWFzZSBub3RlIHRoYXQgYWxsb2NhdGluZyBleHRyYSByZXNvdXJjZSBzbG90cyBpcyBhIHBhaWQgb3B0aW9uLiBQbGVhc2Ugbm90ZSB0aGF0IGhpZ2hcbiAgICogcmVsaWFiaWxpdHkgYWNjb3VudHMgdXNlIHJlZHVuZGFudCBpbmZyYXN0cnVjdHVyZSwgc28gdGhhdCBlYWNoIHJlc291cmNlIHNsb3QgZm9yIGEgaGlnaCByZWxpYWJpbGl0eSBhY2NvdW50XG4gICAqIGlzIGJpbGxlZCBhcyAyIHN0YW5kYXJkIHJlc291cmNlIHNsb3RzLiBEZWZhdWx0IGlzIDEuXG4gICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbY29weUZhY3RvcnlSZXNvdXJjZVNsb3RzXSBOdW1iZXIgb2YgQ29weUZhY3RvcnkgMiByZXNvdXJjZSBzbG90cyB0byBhbGxvY2F0ZSB0byBhY2NvdW50IHJlcGxpY2EuXG4gICAqIEFsbG9jYXRpbmcgZXh0cmEgcmVzb3VyY2Ugc2xvdHMgcmVzdWx0cyBpbiBsb3dlciB0cmFkZSBjb3B5aW5nIGxhdGVuY3kuIFBsZWFzZSBub3RlIHRoYXQgYWxsb2NhdGluZyBleHRyYSByZXNvdXJjZVxuICAgKiBzbG90cyBpcyBhIHBhaWQgb3B0aW9uLiBQbGVhc2UgYWxzbyBub3RlIHRoYXQgQ29weUZhY3RvcnkgMiB1c2VzIHJlZHVuZGFudCBpbmZyYXN0cnVjdHVyZSBzbyB0aGF0XG4gICAqIGVhY2ggQ29weUZhY3RvcnkgcmVzb3VyY2Ugc2xvdCBpcyBiaWxsZWQgYXMgMiBzdGFuZGFyZCByZXNvdXJjZSBzbG90cy4gWW91IHdpbGwgYmUgYmlsbGVkIGZvciBDb3B5RmFjdG9yeSAyXG4gICAqIHJlc291cmNlIHNsb3RzIG9ubHkgaWYgeW91IGhhdmUgYWRkZWQgeW91ciBhY2NvdW50IHRvIENvcHlGYWN0b3J5IDIgYnkgc3BlY2lmeWluZyBjb3B5RmFjdG9yeVJvbGVzIGZpZWxkLlxuICAgKiBEZWZhdWx0IGlzIDEuXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSByZWdpb24gUmVnaW9uIGlkIHRvIGRlcGxveSBhY2NvdW50IHJlcGxpY2EgYXQuIE9uZSBvZiByZXR1cm5lZCBieSB0aGUgL3VzZXJzL2N1cnJlbnQvcmVnaW9ucyBlbmRwb2ludFxuICAgKi9cblxuICAvKipcbiAgICogQ3JlYXRlcyBhIHRyYWRpbmcgYWNjb3VudCByZXBsaWNhIGluIGEgcmVnaW9uIGRpZmZlcmVudCBmcm9tIHRyYWRpbmcgYWNjb3VudCByZWdpb24gYW5kIHN0YXJ0cyBhIGNsb3VkIEFQSSBzZXJ2ZXIgZm9yIGl0XG4gICAqIChzZWUgaHR0cHM6Ly9tZXRhYXBpLmNsb3VkL2RvY3MvcHJvdmlzaW9uaW5nL2FwaS9hY2NvdW50UmVwbGljYS9jcmVhdGVBY2NvdW50UmVwbGljYS8pLlxuICAgKiBJdCBjYW4gdGFrZSBzb21lIHRpbWUgZm9yIHRoZSBBUEkgc2VydmVyIGFuZCB0cmFkaW5nIHRlcm1pbmFsIHRvIHN0YXJ0IGFuZCBjb25uZWN0IHRvIGJyb2tlci5cbiAgICogWW91IGNhbiB1c2UgdGhlIGBjb25uZWN0aW9uU3RhdHVzYCByZXBsaWNhIGZpZWxkIHRvIG1vbml0b3IgdGhlIGN1cnJlbnQgc3RhdHVzIG9mIHRoZSByZXBsaWNhLlxuICAgKiBNZXRob2QgaXMgYWNjZXNzaWJsZSBvbmx5IHdpdGggQVBJIGFjY2VzcyB0b2tlblxuICAgKiBAcGFyYW0ge3N0cmluZ30gYWNjb3VudElkIHByaW1hcnkgYWNjb3VudCBpZFxuICAgKiBAcGFyYW0ge05ld01ldGFUcmFkZXJBY2NvdW50UmVwbGljYUR0b30gYWNjb3VudCBNZXRhVHJhZGVyIGFjY291bnQgZGF0YVxuICAgKiBAcmV0dXJuIHtQcm9taXNlPE1ldGF0cmFkZXJBY2NvdW50SWREdG8+fSBwcm9taXNlIHJlc29sdmluZyB3aXRoIGFuIGlkIGFuZCBzdGF0ZSBvZiB0aGUgTWV0YVRyYWRlciBhY2NvdW50IHJlcGxpY2EgY3JlYXRlZFxuICAgKi9cbiAgY3JlYXRlQWNjb3VudFJlcGxpY2EoYWNjb3VudElkLCBhY2NvdW50KSB7XG4gICAgaWYgKHRoaXMuX2lzTm90Snd0VG9rZW4oKSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZU5vQWNjZXNzRXJyb3IoJ2NyZWF0ZUFjY291bnRSZXBsaWNhJyk7XG4gICAgfVxuICAgIGNvbnN0IG9wdHMgPSB7XG4gICAgICB1cmw6IGAke3RoaXMuX2hvc3R9L3VzZXJzL2N1cnJlbnQvYWNjb3VudHMvJHthY2NvdW50SWR9L3JlcGxpY2FzYCxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnYXV0aC10b2tlbic6IHRoaXMuX3Rva2VuLFxuICAgICAgICAndHJhbnNhY3Rpb24taWQnOiByYW5kb21zdHJpbmcuZ2VuZXJhdGUoMzIpXG4gICAgICB9LFxuICAgICAganNvbjogdHJ1ZSxcbiAgICAgIGRhdGE6IGFjY291bnRcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLl9odHRwQ2xpZW50LnJlcXVlc3Qob3B0cywgJ2NyZWF0ZUFjY291bnRSZXBsaWNhJyk7XG4gIH1cblxuICAvKipcbiAgICogU3RhcnRzIEFQSSBzZXJ2ZXIgYW5kIHRyYWRpbmcgdGVybWluYWwgZm9yIHRyYWRpbmcgYWNjb3VudC5cbiAgICogVGhpcyByZXF1ZXN0IHdpbGwgYmUgaWdub3JlZCBpZiB0aGUgYWNjb3VudCBpcyBhbHJlYWR5IGRlcGxveWVkLlxuICAgKiAoc2VlIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy9hcGkvYWNjb3VudC9kZXBsb3lBY2NvdW50LylcbiAgICogTWV0aG9kIGlzIGFjY2Vzc2libGUgb25seSB3aXRoIEFQSSBhY2Nlc3MgdG9rZW5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGlkIE1ldGFUcmFkZXIgYWNjb3VudCBpZFxuICAgKiBAcmV0dXJuIHtQcm9taXNlfSBwcm9taXNlIHJlc29sdmluZyB3aGVuIE1ldGFUcmFkZXIgYWNjb3VudCBpcyBzY2hlZHVsZWQgZm9yIGRlcGxveW1lbnRcbiAgICovXG4gIGRlcGxveUFjY291bnQoaWQpIHtcbiAgICBpZiAodGhpcy5faXNOb3RKd3RUb2tlbigpKSB7XG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlTm9BY2Nlc3NFcnJvcignZGVwbG95QWNjb3VudCcpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzLyR7aWR9L2RlcGxveWAsXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgfSxcbiAgICAgIGpzb246IHRydWVcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLl9odHRwQ2xpZW50LnJlcXVlc3Qob3B0cywgJ2RlcGxveUFjY291bnQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdGFydHMgQVBJIHNlcnZlciBhbmQgdHJhZGluZyB0ZXJtaW5hbCBmb3IgdHJhZGluZyBhY2NvdW50IHJlcGxpY2EuXG4gICAqIFRoaXMgcmVxdWVzdCB3aWxsIGJlIGlnbm9yZWQgaWYgdGhlIHJlcGxpY2EgaXMgYWxyZWFkeSBkZXBsb3llZFxuICAgKiAoc2VlIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy9hcGkvYWNjb3VudFJlcGxpY2EvZGVwbG95QWNjb3VudFJlcGxpY2EvKVxuICAgKiBNZXRob2QgaXMgYWNjZXNzaWJsZSBvbmx5IHdpdGggQVBJIGFjY2VzcyB0b2tlblxuICAgKiBAcGFyYW0ge3N0cmluZ30gYWNjb3VudElkIE1ldGFUcmFkZXIgYWNjb3VudCBpZFxuICAgKiBAcGFyYW0ge3N0cmluZ30gcmVwbGljYUlkIE1ldGFUcmFkZXIgYWNjb3VudCByZXBsaWNhIGlkXG4gICAqIEByZXR1cm4ge1Byb21pc2V9IHByb21pc2UgcmVzb2x2aW5nIHdoZW4gTWV0YVRyYWRlciBhY2NvdW50IHJlcGxpY2EgaXMgc2NoZWR1bGVkIGZvciBkZXBsb3ltZW50XG4gICAqL1xuICBkZXBsb3lBY2NvdW50UmVwbGljYShhY2NvdW50SWQsIHJlcGxpY2FJZCkge1xuICAgIGlmICh0aGlzLl9pc05vdEp3dFRva2VuKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVOb0FjY2Vzc0Vycm9yKCdkZXBsb3lBY2NvdW50UmVwbGljYScpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzLyR7YWNjb3VudElkfS9yZXBsaWNhcy8ke3JlcGxpY2FJZH0vZGVwbG95YCxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnYXV0aC10b2tlbic6IHRoaXMuX3Rva2VuXG4gICAgICB9LFxuICAgICAganNvbjogdHJ1ZVxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuX2h0dHBDbGllbnQucmVxdWVzdChvcHRzLCAnZGVwbG95QWNjb3VudFJlcGxpY2EnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9wcyBBUEkgc2VydmVyIGFuZCB0cmFkaW5nIHRlcm1pbmFsIGZvciB0cmFkaW5nIGFjY291bnQuXG4gICAqIFRoaXMgcmVxdWVzdCB3aWxsIGJlIGlnbm9yZWQgaWYgdHJhZGluZyBhY2NvdW50IGlzIGFscmVhZHkgdW5kZXBsb3llZFxuICAgKiAoc2VlIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy9hcGkvYWNjb3VudC91bmRlcGxveUFjY291bnQvKVxuICAgKiBNZXRob2QgaXMgYWNjZXNzaWJsZSBvbmx5IHdpdGggQVBJIGFjY2VzcyB0b2tlblxuICAgKiBAcGFyYW0ge3N0cmluZ30gaWQgTWV0YVRyYWRlciBhY2NvdW50IGlkXG4gICAqIEByZXR1cm4ge1Byb21pc2V9IHByb21pc2UgcmVzb2x2aW5nIHdoZW4gTWV0YVRyYWRlciBhY2NvdW50IGlzIHNjaGVkdWxlZCBmb3IgdW5kZXBsb3ltZW50XG4gICAqL1xuICB1bmRlcGxveUFjY291bnQoaWQpIHtcbiAgICBpZiAodGhpcy5faXNOb3RKd3RUb2tlbigpKSB7XG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlTm9BY2Nlc3NFcnJvcigndW5kZXBsb3lBY2NvdW50Jyk7XG4gICAgfVxuICAgIGNvbnN0IG9wdHMgPSB7XG4gICAgICB1cmw6IGAke3RoaXMuX2hvc3R9L3VzZXJzL2N1cnJlbnQvYWNjb3VudHMvJHtpZH0vdW5kZXBsb3lgLFxuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdhdXRoLXRva2VuJzogdGhpcy5fdG9rZW5cbiAgICAgIH0sXG4gICAgICBqc29uOiB0cnVlXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5faHR0cENsaWVudC5yZXF1ZXN0KG9wdHMsICd1bmRlcGxveUFjY291bnQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9wcyBBUEkgc2VydmVyIGFuZCB0cmFkaW5nIHRlcm1pbmFsIGZvciB0cmFkaW5nIGFjY291bnQgcmVwbGljYS5cbiAgICogVGhlIHJlcXVlc3Qgd2lsbCBiZSBpZ25vcmVkIGlmIHRyYWRpbmcgYWNjb3VudCByZXBsaWNhIGlzIGFscmVhZHkgdW5kZXBsb3llZFxuICAgKiAoc2VlIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy9hcGkvYWNjb3VudFJlcGxpY2EvdW5kZXBsb3lBY2NvdW50UmVwbGljYS8pXG4gICAqIE1ldGhvZCBpcyBhY2Nlc3NpYmxlIG9ubHkgd2l0aCBBUEkgYWNjZXNzIHRva2VuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBhY2NvdW50SWQgTWV0YVRyYWRlciBwcmltYXJ5IGFjY291bnQgaWRcbiAgICogQHBhcmFtIHtzdHJpbmd9IHJlcGxpY2FJZCBNZXRhVHJhZGVyIGFjY291bnQgcmVwbGljYSBpZFxuICAgKiBAcmV0dXJuIHtQcm9taXNlfSBwcm9taXNlIHJlc29sdmluZyB3aGVuIE1ldGFUcmFkZXIgYWNjb3VudCByZXBsaWNhIGlzIHNjaGVkdWxlZCBmb3IgdW5kZXBsb3ltZW50XG4gICAqL1xuICB1bmRlcGxveUFjY291bnRSZXBsaWNhKGFjY291bnRJZCwgcmVwbGljYUlkKSB7XG4gICAgaWYgKHRoaXMuX2lzTm90Snd0VG9rZW4oKSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZU5vQWNjZXNzRXJyb3IoJ3VuZGVwbG95QWNjb3VudFJlcGxpY2EnKTtcbiAgICB9XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIHVybDogYCR7dGhpcy5faG9zdH0vdXNlcnMvY3VycmVudC9hY2NvdW50cy8ke2FjY291bnRJZH0vcmVwbGljYXMvJHtyZXBsaWNhSWR9L3VuZGVwbG95YCxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnYXV0aC10b2tlbic6IHRoaXMuX3Rva2VuXG4gICAgICB9LFxuICAgICAganNvbjogdHJ1ZVxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuX2h0dHBDbGllbnQucmVxdWVzdChvcHRzLCAndW5kZXBsb3lBY2NvdW50UmVwbGljYScpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZGVwbG95cyB0cmFkaW5nIGFjY291bnQuIFRoaXMgaXMgZXF1aXZhbGVudCB0byB1bmRlcGxveSBpbW1lZGlhdGVseSBmb2xsb3dlZCBieSBkZXBsb3lcbiAgICogKHNlZSBodHRwczovL21ldGFhcGkuY2xvdWQvZG9jcy9wcm92aXNpb25pbmcvYXBpL2FjY291bnQvcmVkZXBsb3lBY2NvdW50LylcbiAgICogTWV0aG9kIGlzIGFjY2Vzc2libGUgb25seSB3aXRoIEFQSSBhY2Nlc3MgdG9rZW5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGlkIE1ldGFUcmFkZXIgYWNjb3VudCBpZFxuICAgKiBAcmV0dXJuIHtQcm9taXNlfSBwcm9taXNlIHJlc29sdmluZyB3aGVuIE1ldGFUcmFkZXIgYWNjb3VudCBpcyBzY2hlZHVsZWQgZm9yIHJlZGVwbG95bWVudFxuICAgKi9cbiAgcmVkZXBsb3lBY2NvdW50KGlkKSB7XG4gICAgaWYgKHRoaXMuX2lzTm90Snd0VG9rZW4oKSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZU5vQWNjZXNzRXJyb3IoJ3JlZGVwbG95QWNjb3VudCcpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzLyR7aWR9L3JlZGVwbG95YCxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnYXV0aC10b2tlbic6IHRoaXMuX3Rva2VuXG4gICAgICB9LFxuICAgICAganNvbjogdHJ1ZVxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuX2h0dHBDbGllbnQucmVxdWVzdChvcHRzLCAncmVkZXBsb3lBY2NvdW50Jyk7XG4gIH1cblxuICAvKipcbiAgICogUmVkZXBsb3lzIHRyYWRpbmcgYWNjb3VudCByZXBsaWNhLiBUaGlzIGlzIGVxdWl2YWxlbnQgdG8gdW5kZXBsb3kgaW1tZWRpYXRlbHkgZm9sbG93ZWQgYnkgZGVwbG95LlxuICAgKiAoc2VlIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy9hcGkvYWNjb3VudC9yZWRlcGxveUFjY291bnRSZXBsaWNhLylcbiAgICogTWV0aG9kIGlzIGFjY2Vzc2libGUgb25seSB3aXRoIEFQSSBhY2Nlc3MgdG9rZW5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGFjY291bnRJZCBNZXRhVHJhZGVyIHByaW1hcnkgYWNjb3VudCBpZFxuICAgKiBAcGFyYW0ge3N0cmluZ30gcmVwbGljYUlkIE1ldGFUcmFkZXIgYWNjb3VudCByZXBsaWNhIGlkXG4gICAqIEByZXR1cm4ge1Byb21pc2V9IHByb21pc2UgcmVzb2x2aW5nIHdoZW4gTWV0YVRyYWRlciBhY2NvdW50IHJlcGxpY2EgaXMgc2NoZWR1bGVkIGZvciByZWRlcGxveW1lbnRcbiAgICovXG4gIHJlZGVwbG95QWNjb3VudFJlcGxpY2EoYWNjb3VudElkLCByZXBsaWNhSWQpIHtcbiAgICBpZiAodGhpcy5faXNOb3RKd3RUb2tlbigpKSB7XG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlTm9BY2Nlc3NFcnJvcigncmVkZXBsb3lBY2NvdW50UmVwbGljYScpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzLyR7YWNjb3VudElkfS9yZXBsaWNhcy8ke3JlcGxpY2FJZH0vcmVkZXBsb3lgLFxuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdhdXRoLXRva2VuJzogdGhpcy5fdG9rZW5cbiAgICAgIH0sXG4gICAgICBqc29uOiB0cnVlXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5faHR0cENsaWVudC5yZXF1ZXN0KG9wdHMsICdyZWRlcGxveUFjY291bnRSZXBsaWNhJyk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlcyBhIHRyYWRpbmcgYWNjb3VudCBhbmQgc3RvcHMgdGhlIEFQSSBzZXJ2ZXIgc2VydmluZyB0aGUgYWNjb3VudC5cbiAgICogVGhlIGFjY291bnQgc3RhdGUgc3VjaCBhcyBkb3dubG9hZGVkIG1hcmtldCBkYXRhIGhpc3Rvcnkgd2lsbCBiZSByZW1vdmVkIGFzIHdlbGwgd2hlbiB5b3UgcmVtb3ZlIHRoZSBhY2NvdW50LlxuICAgKiAoc2VlIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy9hcGkvYWNjb3VudC9kZWxldGVBY2NvdW50LykuXG4gICAqIE1ldGhvZCBpcyBhY2Nlc3NpYmxlIG9ubHkgd2l0aCBBUEkgYWNjZXNzIHRva2VuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBpZCBJZCBvZiB0aGUgYWNjb3VudCB0byBiZSBkZWxldGVkXG4gICAqIEByZXR1cm4ge1Byb21pc2V9IHByb21pc2UgcmVzb2x2aW5nIHdoZW4gTWV0YVRyYWRlciBhY2NvdW50IGlzIHNjaGVkdWxlZCBmb3IgZGVsZXRpb25cbiAgICovXG4gIGRlbGV0ZUFjY291bnQoaWQpIHtcbiAgICBpZiAodGhpcy5faXNOb3RKd3RUb2tlbigpKSB7XG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlTm9BY2Nlc3NFcnJvcignZGVsZXRlQWNjb3VudCcpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzLyR7aWR9YCxcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdhdXRoLXRva2VuJzogdGhpcy5fdG9rZW5cbiAgICAgIH0sXG4gICAgICBqc29uOiB0cnVlXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5faHR0cENsaWVudC5yZXF1ZXN0KG9wdHMsICdkZWxldGVBY2NvdW50Jyk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlcyBhIHRyYWRpbmcgYWNjb3VudCByZXBsaWNhIGFuZCBzdG9wcyB0aGUgQVBJIHNlcnZlciBzZXJ2aW5nIHRoZSByZXBsaWNhXG4gICAqIChzZWUgaHR0cHM6Ly9tZXRhYXBpLmNsb3VkL2RvY3MvcHJvdmlzaW9uaW5nL2FwaS9hY2NvdW50L2RlbGV0ZUFjY291bnRSZXBsaWNhLykuXG4gICAqIE1ldGhvZCBpcyBhY2Nlc3NpYmxlIG9ubHkgd2l0aCBBUEkgYWNjZXNzIHRva2VuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBhY2NvdW50SWQgcHJpbWFyeSBhY2NvdW50IGlkXG4gICAqIEBwYXJhbSB7c3RyaW5nfSByZXBsaWNhSWQgSWQgb2YgdGhlIGFjY291bnQgcmVwbGljYSB0byBiZSBkZWxldGVkXG4gICAqIEByZXR1cm4ge1Byb21pc2V9IHByb21pc2UgcmVzb2x2aW5nIHdoZW4gTWV0YVRyYWRlciBhY2NvdW50IHJlcGxpY2EgaXMgc2NoZWR1bGVkIGZvciBkZWxldGlvblxuICAgKi9cbiAgZGVsZXRlQWNjb3VudFJlcGxpY2EoYWNjb3VudElkLCByZXBsaWNhSWQpIHtcbiAgICBpZiAodGhpcy5faXNOb3RKd3RUb2tlbigpKSB7XG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlTm9BY2Nlc3NFcnJvcignZGVsZXRlQWNjb3VudFJlcGxpY2EnKTtcbiAgICB9XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIHVybDogYCR7dGhpcy5faG9zdH0vdXNlcnMvY3VycmVudC9hY2NvdW50cy8ke2FjY291bnRJZH0vcmVwbGljYXMvJHtyZXBsaWNhSWR9YCxcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdhdXRoLXRva2VuJzogdGhpcy5fdG9rZW5cbiAgICAgIH0sXG4gICAgICBqc29uOiB0cnVlXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5faHR0cENsaWVudC5yZXF1ZXN0KG9wdHMsICdkZWxldGVBY2NvdW50UmVwbGljYScpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZWQgTWV0YVRyYWRlciBhY2NvdW50IGRhdGFcbiAgICogQHR5cGVkZWYge09iamVjdH0gTWV0YXRyYWRlckFjY291bnRVcGRhdGVEdG9cbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IG5hbWUgSHVtYW4tcmVhZGFibGUgYWNjb3VudCBuYW1lXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbcGFzc3dvcmRdIE1ldGFUcmFkZXIgYWNjb3VudCBwYXNzd29yZC4gVGhlIHBhc3N3b3JkIGNhbiBiZSBlaXRoZXIgaW52ZXN0b3IgcGFzc3dvcmQgZm9yIHJlYWQtb25seVxuICAgKiBhY2Nlc3Mgb3IgcHJvdmlkZXIgcGFzc3dvcmQgdG8gZW5hYmxlIHRyYWRpbmcgZmVhdHVyZXNcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IHNlcnZlciBNZXRhVHJhZGVyIHNlcnZlciBuYW1lIHRvIGNvbm5lY3QgdG9cbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IFttYWdpY10gTWFnaWMgdmFsdWUgdGhlIHRyYWRlcyBzaG91bGQgYmUgcGVyZm9ybWVkIHVzaW5nLlxuICAgKiBXaGVuIG1hbnVhbFRyYWRlcyBmaWVsZCBpcyBzZXQgdG8gdHJ1ZSwgbWFnaWMgdmFsdWUgbXVzdCBiZSAwXG4gICAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gW21hbnVhbFRyYWRlc10gRmxhZyBpbmRpY2F0aW5nIGlmIHRyYWRlcyBzaG91bGQgYmUgcGxhY2VkIGFzIG1hbnVhbCB0cmFkZXMuIFN1cHBvcnRlZCBmb3IgRzIgb25seS5cbiAgICogRGVmYXVsdCBpcyBmYWxzZS5cbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IFtzbGlwcGFnZV0gRGVmYXVsdCB0cmFkZSBzbGlwcGFnZSBpbiBwb2ludHMuIFNob3VsZCBiZSBncmVhdGVyIG9yIGVxdWFsIHRvIHplcm8uIElmIG5vdCBzcGVjaWZpZWQsXG4gICAqIHN5c3RlbSBpbnRlcm5hbCBzZXR0aW5nIHdpbGwgYmUgdXNlZCB3aGljaCB3ZSBiZWxpZXZlIGlzIHJlYXNvbmFibGUgZm9yIG1vc3QgY2FzZXNcbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IFtxdW90ZVN0cmVhbWluZ0ludGVydmFsSW5TZWNvbmRzXSBRdW90ZSBzdHJlYW1pbmcgaW50ZXJ2YWwgaW4gc2Vjb25kcy4gU2V0IHRvIDAgaW4gb3JkZXIgdG9cbiAgICogcmVjZWl2ZSBxdW90ZXMgb24gZWFjaCB0aWNrLiBJbnRlcnZhbHMgbGVzcyB0aGFuIDIuNSBzZWNvbmRzIGFyZSBzdXBwb3J0ZWQgb25seSBmb3IgRzIuXG4gICAqIERlZmF1bHQgdmFsdWUgaXMgMi41IHNlY29uZHNcbiAgICogQHByb3BlcnR5IHtBcnJheTxzdHJpbmc+fSBbdGFnc10gTWV0YVRyYWRlciBhY2NvdW50IHRhZ3NcbiAgICogQHByb3BlcnR5IHtPYmplY3R9IFttZXRhZGF0YV0gZXh0cmEgaW5mb3JtYXRpb24gd2hpY2ggY2FuIGJlIHN0b3JlZCB0b2dldGhlciB3aXRoIHlvdXIgYWNjb3VudFxuICAgKiBAcHJvcGVydHkge251bWJlcn0gW3Jlc291cmNlU2xvdHNdIE51bWJlciBvZiByZXNvdXJjZSBzbG90cyB0byBhbGxvY2F0ZSB0byBhY2NvdW50LiBBbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlIHNsb3RzXG4gICAqIHJlc3VsdHMgaW4gYmV0dGVyIGFjY291bnQgcGVyZm9ybWFuY2UgdW5kZXIgbG9hZCB3aGljaCBpcyB1c2VmdWwgZm9yIHNvbWUgYXBwbGljYXRpb25zLiBFLmcuIGlmIHlvdSBoYXZlIG1hbnlcbiAgICogYWNjb3VudHMgY29weWluZyB0aGUgc2FtZSBzdHJhdGVneSB2aWEgQ29veUZhY3RvcnkgQVBJLCB0aGVuIHlvdSBjYW4gaW5jcmVhc2UgcmVzb3VyY2VTbG90cyB0byBnZXQgYSBsb3dlciB0cmFkZVxuICAgKiBjb3B5aW5nIGxhdGVuY3kuIFBsZWFzZSBub3RlIHRoYXQgYWxsb2NhdGluZyBleHRyYSByZXNvdXJjZSBzbG90cyBpcyBhIHBhaWQgb3B0aW9uLiBEZWZhdWx0IGlzIDFcbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IFtjb3B5RmFjdG9yeVJlc291cmNlU2xvdHNdIE51bWJlciBvZiBDb3B5RmFjdG9yeSAyIHJlc291cmNlIHNsb3RzIHRvIGFsbG9jYXRlIHRvIGFjY291bnQuXG4gICAqIEFsbG9jYXRpbmcgZXh0cmEgcmVzb3VyY2Ugc2xvdHMgcmVzdWx0cyBpbiBsb3dlciB0cmFkZSBjb3B5aW5nIGxhdGVuY3kuIFBsZWFzZSBub3RlIHRoYXQgYWxsb2NhdGluZyBleHRyYSByZXNvdXJjZVxuICAgKiBzbG90cyBpcyBhIHBhaWQgb3B0aW9uLiBQbGVhc2UgYWxzbyBub3RlIHRoYXQgQ29weUZhY3RvcnkgMiB1c2VzIHJlZHVuZGFudCBpbmZyYXN0cnVjdHVyZSBzbyB0aGF0XG4gICAqIGVhY2ggQ29weUZhY3RvcnkgcmVzb3VyY2Ugc2xvdCBpcyBiaWxsZWQgYXMgMiBzdGFuZGFyZCByZXNvdXJjZSBzbG90cy4gWW91IHdpbGwgYmUgYmlsbGVkIGZvciBDb3B5RmFjdG9yeSAyXG4gICAqIHJlc291cmNlIHNsb3RzIG9ubHkgaWYgeW91IGhhdmUgYWRkZWQgeW91ciBhY2NvdW50IHRvIENvcHlGYWN0b3J5IDIgYnkgc3BlY2lmeWluZyBjb3B5RmFjdG9yeVJvbGVzIGZpZWxkLlxuICAgKiBEZWZhdWx0IGlzIDEuIFxuICAgKi9cblxuICAvKipcbiAgICogVXBkYXRlcyB0cmFkaW5nIGFjY291bnQuIFxuICAgKiBQbGVhc2UgcmVkZXBsb3kgdGhlIHRyYWRpbmcgYWNjb3VudCBpbiBvcmRlciBmb3IgdXBkYXRlZCBzZXR0aW5ncyB0byB0YWtlIGVmZmVjdFxuICAgKiAoc2VlIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy9hcGkvYWNjb3VudC91cGRhdGVBY2NvdW50LykuXG4gICAqIE1ldGhvZCBpcyBhY2Nlc3NpYmxlIG9ubHkgd2l0aCBBUEkgYWNjZXNzIHRva2VuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBpZCBNZXRhVHJhZGVyIGFjY291bnQgaWRcbiAgICogQHBhcmFtIHtNZXRhdHJhZGVyQWNjb3VudFVwZGF0ZUR0b30gYWNjb3VudCB1cGRhdGVkIGFjY291bnQgaW5mb3JtYXRpb25cbiAgICogQHJldHVybiB7UHJvbWlzZX0gcHJvbWlzZSByZXNvbHZpbmcgd2hlbiBNZXRhVHJhZGVyIGFjY291bnQgaXMgdXBkYXRlZFxuICAgKi9cbiAgdXBkYXRlQWNjb3VudChpZCwgYWNjb3VudCkge1xuICAgIGlmICh0aGlzLl9pc05vdEp3dFRva2VuKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVOb0FjY2Vzc0Vycm9yKCd1cGRhdGVBY2NvdW50Jyk7XG4gICAgfVxuICAgIGNvbnN0IG9wdHMgPSB7XG4gICAgICB1cmw6IGAke3RoaXMuX2hvc3R9L3VzZXJzL2N1cnJlbnQvYWNjb3VudHMvJHtpZH1gLFxuICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgfSxcbiAgICAgIGpzb246IHRydWUsXG4gICAgICBkYXRhOiBhY2NvdW50XG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5faHR0cENsaWVudC5yZXF1ZXN0KG9wdHMsICd1cGRhdGVBY2NvdW50Jyk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlZCBNZXRhVHJhZGVyIGFjY291bnQgcmVwbGljYSBkYXRhXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IFVwZGF0ZWRNZXRhdHJhZGVyQWNjb3VudFJlcGxpY2FEdG9cbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IFttYWdpY10gTWFnaWMgdmFsdWUgdGhlIHRyYWRlcyBzaG91bGQgYmUgcGVyZm9ybWVkIHVzaW5nLlxuICAgKiBXaGVuIG1hbnVhbFRyYWRlcyBmaWVsZCBpcyBzZXQgdG8gdHJ1ZSwgbWFnaWMgdmFsdWUgbXVzdCBiZSAwXG4gICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbcXVvdGVTdHJlYW1pbmdJbnRlcnZhbEluU2Vjb25kc10gUXVvdGUgc3RyZWFtaW5nIGludGVydmFsIGluIHNlY29uZHMuIFNldCB0byAwIGluIG9yZGVyIHRvXG4gICAqIHJlY2VpdmUgcXVvdGVzIG9uIGVhY2ggdGljay4gRGVmYXVsdCB2YWx1ZSBpcyAyLjUgc2Vjb25kcy4gSW50ZXJ2YWxzIGxlc3MgdGhhbiAyLjUgc2Vjb25kcyBhcmUgc3VwcG9ydGVkXG4gICAqIG9ubHkgZm9yIEcyXG4gICAqIEBwcm9wZXJ0eSB7QXJyYXk8c3RyaW5nPn0gW3RhZ3NdIE1ldGFUcmFkZXIgYWNjb3VudCB0YWdzXG4gICAqIEBwcm9wZXJ0eSB7T2JqZWN0fSBbbWV0YWRhdGFdIGV4dHJhIGluZm9ybWF0aW9uIHdoaWNoIGNhbiBiZSBzdG9yZWQgdG9nZXRoZXIgd2l0aCB5b3VyIGFjY291bnRcbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IFtyZXNvdXJjZVNsb3RzXSBOdW1iZXIgb2YgcmVzb3VyY2Ugc2xvdHMgdG8gYWxsb2NhdGUgdG8gYWNjb3VudC4gQWxsb2NhdGluZyBleHRyYSByZXNvdXJjZSBzbG90c1xuICAgKiByZXN1bHRzIGluIGJldHRlciBhY2NvdW50IHBlcmZvcm1hbmNlIHVuZGVyIGxvYWQgd2hpY2ggaXMgdXNlZnVsIGZvciBzb21lIGFwcGxpY2F0aW9ucy4gRS5nLiBpZiB5b3UgaGF2ZSBtYW55XG4gICAqIGFjY291bnRzIGNvcHlpbmcgdGhlIHNhbWUgc3RyYXRlZ3kgdmlhIENvb3lGYWN0b3J5IEFQSSwgdGhlbiB5b3UgY2FuIGluY3JlYXNlIHJlc291cmNlU2xvdHMgdG8gZ2V0IGEgbG93ZXIgdHJhZGVcbiAgICogY29weWluZyBsYXRlbmN5LiBQbGVhc2Ugbm90ZSB0aGF0IGFsbG9jYXRpbmcgZXh0cmEgcmVzb3VyY2Ugc2xvdHMgaXMgYSBwYWlkIG9wdGlvbi4gRGVmYXVsdCBpcyAxXG4gICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbY29weUZhY3RvcnlSZXNvdXJjZVNsb3RzXSBOdW1iZXIgb2YgQ29weUZhY3RvcnkgMiByZXNvdXJjZSBzbG90cyB0byBhbGxvY2F0ZSB0byBhY2NvdW50LlxuICAgKiBBbGxvY2F0aW5nIGV4dHJhIHJlc291cmNlIHNsb3RzIHJlc3VsdHMgaW4gbG93ZXIgdHJhZGUgY29weWluZyBsYXRlbmN5LiBQbGVhc2Ugbm90ZSB0aGF0IGFsbG9jYXRpbmcgZXh0cmEgcmVzb3VyY2VcbiAgICogc2xvdHMgaXMgYSBwYWlkIG9wdGlvbi4gUGxlYXNlIGFsc28gbm90ZSB0aGF0IENvcHlGYWN0b3J5IDIgdXNlcyByZWR1bmRhbnQgaW5mcmFzdHJ1Y3R1cmUgc28gdGhhdFxuICAgKiBlYWNoIENvcHlGYWN0b3J5IHJlc291cmNlIHNsb3QgaXMgYmlsbGVkIGFzIDIgc3RhbmRhcmQgcmVzb3VyY2Ugc2xvdHMuIFlvdSB3aWxsIGJlIGJpbGxlZCBmb3IgQ29weUZhY3RvcnkgMlxuICAgKiByZXNvdXJjZSBzbG90cyBvbmx5IGlmIHlvdSBoYXZlIGFkZGVkIHlvdXIgYWNjb3VudCB0byBDb3B5RmFjdG9yeSAyIGJ5IHNwZWNpZnlpbmcgY29weUZhY3RvcnlSb2xlcyBmaWVsZC5cbiAgICogRGVmYXVsdCBpcyAxLlxuICAgKi9cblxuICAvKipcbiAgICogVXBkYXRlcyB0cmFkaW5nIGFjY291bnQgcmVwbGljYSAoc2VlXG4gICAqIGh0dHBzOi8vbWV0YWFwaS5jbG91ZC9kb2NzL3Byb3Zpc2lvbmluZy9hcGkvYWNjb3VudC91cGRhdGVBY2NvdW50UmVwbGljYS8pLlxuICAgKiBNZXRob2QgaXMgYWNjZXNzaWJsZSBvbmx5IHdpdGggQVBJIGFjY2VzcyB0b2tlblxuICAgKiBAcGFyYW0ge3N0cmluZ30gYWNjb3VudElkIE1ldGFUcmFkZXIgcHJpbWFyeSBhY2NvdW50IGlkXG4gICAqIEBwYXJhbSB7c3RyaW5nfSByZXBsaWNhSWQgTWV0YVRyYWRlciBhY2NvdW50IHJlcGxpY2EgaWRcbiAgICogQHBhcmFtIHtVcGRhdGVkTWV0YXRyYWRlckFjY291bnRSZXBsaWNhRHRvfSBtZXRhdHJhZGVyQWNjb3VudCB1cGRhdGVkIGFjY291bnQgcmVwbGljYSBpbmZvcm1hdGlvblxuICAgKiBAcmV0dXJuIHtQcm9taXNlfSBwcm9taXNlIHJlc29sdmluZyB3aGVuIE1ldGFUcmFkZXIgYWNjb3VudCByZXBsaWNhIGlzIHVwZGF0ZWRcbiAgICovXG4gIHVwZGF0ZUFjY291bnRSZXBsaWNhKGFjY291bnRJZCwgcmVwbGljYUlkLCBtZXRhdHJhZGVyQWNjb3VudCkge1xuICAgIGlmICh0aGlzLl9pc05vdEp3dFRva2VuKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVOb0FjY2Vzc0Vycm9yKCd1cGRhdGVBY2NvdW50UmVwbGljYScpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzLyR7YWNjb3VudElkfS9yZXBsaWNhcy8ke3JlcGxpY2FJZH1gLFxuICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgfSxcbiAgICAgIGpzb246IHRydWUsXG4gICAgICBkYXRhOiBtZXRhdHJhZGVyQWNjb3VudFxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuX2h0dHBDbGllbnQucmVxdWVzdChvcHRzLCAndXBkYXRlQWNjb3VudFJlcGxpY2EnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbmNyZWFzZXMgdHJhZGluZyBhY2NvdW50IHJlbGlhYmlsaXR5IGluIG9yZGVyIHRvIGluY3JlYXNlIHRoZSBleHBlY3RlZCBhY2NvdW50IHVwdGltZS5cbiAgICogVGhlIGFjY291bnQgd2lsbCBiZSB0ZW1wb3Jhcnkgc3RvcHBlZCB0byBwZXJmb3JtIHRoaXMgYWN0aW9uLlxuICAgKiBOb3RlIHRoYXQgaW5jcmVhc2luZyByZWxpYWJpbGl0eSBpcyBhIHBhaWQgb3B0aW9uIChzZWVcbiAgICogaHR0cHM6Ly9tZXRhYXBpLmNsb3VkL2RvY3MvcHJvdmlzaW9uaW5nL2FwaS9hY2NvdW50L2luY3JlYXNlUmVsaWFiaWxpdHkvKS5cbiAgICogTWV0aG9kIGlzIGFjY2Vzc2libGUgb25seSB3aXRoIEFQSSBhY2Nlc3MgdG9rZW5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGlkIE1ldGFUcmFkZXIgYWNjb3VudCBpZFxuICAgKiBAcmV0dXJuIHtQcm9taXNlfSBwcm9taXNlIHJlc29sdmluZyB3aGVuIE1ldGFUcmFkZXIgYWNjb3VudCByZWxpYWJpbGl0eSBpcyBpbmNyZWFzZWRcbiAgICovXG4gIGluY3JlYXNlUmVsaWFiaWxpdHkoaWQpIHtcbiAgICBpZiAodGhpcy5faXNOb3RKd3RUb2tlbigpKSB7XG4gICAgICByZXR1cm4gdGhpcy5faGFuZGxlTm9BY2Nlc3NFcnJvcignaW5jcmVhc2VSZWxpYWJpbGl0eScpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzLyR7aWR9L2luY3JlYXNlLXJlbGlhYmlsaXR5YCxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnYXV0aC10b2tlbic6IHRoaXMuX3Rva2VuXG4gICAgICB9LFxuICAgICAganNvbjogdHJ1ZVxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuX2h0dHBDbGllbnQucmVxdWVzdChvcHRzLCAnaW5jcmVhc2VSZWxpYWJpbGl0eScpO1xuICB9XG5cbiAgLyoqXG4gICAqIEVuYWJsZXMgcmlzayBtYW5hZ2VtZW50IEFQSSBmb3IgdHJhZGluZyBhY2NvdW50LlxuICAgKiBUaGUgYWNjb3VudCB3aWxsIGJlIHRlbXBvcmFyeSBzdG9wcGVkIHRvIHBlcmZvcm0gdGhpcyBhY3Rpb24uXG4gICAqIE5vdGUgdGhhdCByaXNrIG1hbmFnZW1lbnQgQVBJIGlzIGEgcGFpZCBvcHRpb24gKHNlZVxuICAgKiBodHRwczovL21ldGFhcGkuY2xvdWQvZG9jcy9wcm92aXNpb25pbmcvYXBpL2FjY291bnQvZW5hYmxlUmlza01hbmFnZW1lbnRBcGkvKS5cbiAgICogTWV0aG9kIGlzIGFjY2Vzc2libGUgb25seSB3aXRoIEFQSSBhY2Nlc3MgdG9rZW5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGlkIE1ldGFUcmFkZXIgYWNjb3VudCBpZFxuICAgKiBAcmV0dXJuIHtQcm9taXNlfSBwcm9taXNlIHJlc29sdmluZyB3aGVuIGFjY291bnQgcmlzayBtYW5hZ2VtZW50IGlzIGVuYWJsZWRcbiAgICovXG4gIGVuYWJsZVJpc2tNYW5hZ2VtZW50QXBpKGlkKSB7XG4gICAgaWYgKHRoaXMuX2lzTm90Snd0VG9rZW4oKSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZU5vQWNjZXNzRXJyb3IoJ2VuYWJsZVJpc2tNYW5hZ2VtZW50QXBpJyk7XG4gICAgfVxuICAgIGNvbnN0IG9wdHMgPSB7XG4gICAgICB1cmw6IGAke3RoaXMuX2hvc3R9L3VzZXJzL2N1cnJlbnQvYWNjb3VudHMvJHtpZH0vZW5hYmxlLXJpc2stbWFuYWdlbWVudC1hcGlgLFxuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdhdXRoLXRva2VuJzogdGhpcy5fdG9rZW5cbiAgICAgIH0sXG4gICAgICBqc29uOiB0cnVlXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5faHR0cENsaWVudC5yZXF1ZXN0KG9wdHMsICdlbmFibGVSaXNrTWFuYWdlbWVudEFwaScpO1xuICB9XG5cbiAgLyoqXG4gICAqIEVuYWJsZXMgTWV0YVN0YXRzIEFQSSBmb3IgdHJhZGluZyBhY2NvdW50LlxuICAgKiBUaGUgYWNjb3VudCB3aWxsIGJlIHRlbXBvcmFyeSBzdG9wcGVkIHRvIHBlcmZvcm0gdGhpcyBhY3Rpb24uXG4gICAqIE5vdGUgdGhhdCB0aGlzIGlzIGEgcGFpZCBvcHRpb24gKHNlZVxuICAgKiBodHRwczovL21ldGFhcGkuY2xvdWQvZG9jcy9wcm92aXNpb25pbmcvYXBpL2FjY291bnQvZW5hYmxlTWV0YVN0YXRzQXBpLykuXG4gICAqIE1ldGhvZCBpcyBhY2Nlc3NpYmxlIG9ubHkgd2l0aCBBUEkgYWNjZXNzIHRva2VuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBpZCBNZXRhVHJhZGVyIGFjY291bnQgaWRcbiAgICogQHJldHVybiB7UHJvbWlzZX0gcHJvbWlzZSByZXNvbHZpbmcgd2hlbiBhY2NvdW50IE1ldGFTdGF0cyBBUEkgaXMgZW5hYmxlZFxuICAgKi9cbiAgZW5hYmxlTWV0YVN0YXRzQXBpKGlkKSB7XG4gICAgaWYgKHRoaXMuX2lzTm90Snd0VG9rZW4oKSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2hhbmRsZU5vQWNjZXNzRXJyb3IoJ2VuYWJsZU1ldGFTdGF0c0FwaScpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzLyR7aWR9L2VuYWJsZS1tZXRhc3RhdHMtYXBpYCxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnYXV0aC10b2tlbic6IHRoaXMuX3Rva2VuXG4gICAgICB9LFxuICAgICAganNvbjogdHJ1ZVxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuX2h0dHBDbGllbnQucmVxdWVzdChvcHRzLCAnZW5hYmxlTWV0YVN0YXRzQXBpJyk7XG4gIH1cblxuICAvKipcbiAgICogQ29uZmlndXJhdGlvbiBsaW5rXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IENvbmZpZ3VyYXRpb25MaW5rXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBjb25maWd1cmF0aW9uTGluayBTZWN1cmUgbGluayB0byBhbGxvdyBlbmQgdXNlciB0byBjb25maWd1cmUgYWNjb3VudCBkaXJlY3RseVxuICAgKi9cblxuICAvKipcbiAgICogR2VuZXJhdGVzIHRyYWRpbmcgYWNjb3VudCBjb25maWd1cmF0aW9uIGxpbmsgYnkgYWNjb3VudCBpZC5cbiAgICogKHNlZSBodHRwczovL21ldGFhcGkuY2xvdWQvZG9jcy9wcm92aXNpb25pbmcvYXBpL2FjY291bnQvY3JlYXRlQ29uZmlndXJhdGlvbkxpbmsvKVxuICAgKiBUaGlzIGxpbmsgY2FuIGJlIHVzZWQgYnkgdGhlIGVuZCB1c2VyIHRvIGVudGVyIHRyYWRpbmcgYWNjb3VudCBsb2dpbiBhbmQgcGFzc3dvcmQgb3IgY2hhbmdlIHRoZSBwYXNzd29yZC5cbiAgICogTWV0aG9kIGlzIGFjY2Vzc2libGUgb25seSB3aXRoIEFQSSBhY2Nlc3MgdG9rZW5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGFjY291bnRJZCBUcmFkaW5nIGFjY291bnQgaWRcbiAgICogQHBhcmFtIHtudW1iZXJ9IFt0dGxJbkRheXNdIExpZmV0aW1lIG9mIHRoZSBsaW5rIGluIGRheXMuIERlZmF1bHQgaXMgNy5cbiAgICogQHJldHVybiB7UHJvbWlzZTxDb25maWd1cmF0aW9uTGluaz59IHByb21pc2UgcmVzb2x2aW5nIHdpdGggY29uZmlndXJhdGlvbiBsaW5rXG4gICAqL1xuICBjcmVhdGVDb25maWd1cmF0aW9uTGluayhhY2NvdW50SWQsIHR0bEluRGF5cykge1xuICAgIGlmICh0aGlzLl9pc05vdEp3dFRva2VuKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVOb0FjY2Vzc0Vycm9yKCdjcmVhdGVDb25maWd1cmF0aW9uTGluaycpO1xuICAgIH1cbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgdXJsOiBgJHt0aGlzLl9ob3N0fS91c2Vycy9jdXJyZW50L2FjY291bnRzLyR7YWNjb3VudElkfS9jb25maWd1cmF0aW9uLWxpbmtgLFxuICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2F1dGgtdG9rZW4nOiB0aGlzLl90b2tlblxuICAgICAgfSxcbiAgICAgIHBhcmFtczoge1xuICAgICAgICB0dGxJbkRheXM6IHR0bEluRGF5c1xuICAgICAgfSxcbiAgICAgIGpzb246IHRydWVcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLl9odHRwQ2xpZW50LnJlcXVlc3Qob3B0cywgJ2NyZWF0ZUNvbmZpZ3VyYXRpb25MaW5rJyk7XG4gIH1cblxufVxuIl0sIm5hbWVzIjpbIk1ldGFBcGlDbGllbnQiLCJyYW5kb21zdHJpbmciLCJNZXRhdHJhZGVyQWNjb3VudENsaWVudCIsImdldEFjY291bnRzIiwiYWNjb3VudHNGaWx0ZXIiLCJhcGlWZXJzaW9uIiwiX2lzTm90Snd0VG9rZW4iLCJfaGFuZGxlTm9BY2Nlc3NFcnJvciIsIm9wdHMiLCJ1cmwiLCJfaG9zdCIsIm1ldGhvZCIsInBhcmFtcyIsImhlYWRlcnMiLCJfdG9rZW4iLCJqc29uIiwiX2h0dHBDbGllbnQiLCJyZXF1ZXN0IiwiZ2V0QWNjb3VudCIsImlkIiwiZ2V0QWNjb3VudFJlcGxpY2EiLCJhY2NvdW50SWQiLCJyZXBsaWNhSWQiLCJnZXRBY2NvdW50UmVwbGljYXMiLCJjcmVhdGVBY2NvdW50IiwiYWNjb3VudCIsImdlbmVyYXRlIiwiZGF0YSIsImNyZWF0ZUFjY291bnRSZXBsaWNhIiwiZGVwbG95QWNjb3VudCIsImRlcGxveUFjY291bnRSZXBsaWNhIiwidW5kZXBsb3lBY2NvdW50IiwidW5kZXBsb3lBY2NvdW50UmVwbGljYSIsInJlZGVwbG95QWNjb3VudCIsInJlZGVwbG95QWNjb3VudFJlcGxpY2EiLCJkZWxldGVBY2NvdW50IiwiZGVsZXRlQWNjb3VudFJlcGxpY2EiLCJ1cGRhdGVBY2NvdW50IiwidXBkYXRlQWNjb3VudFJlcGxpY2EiLCJtZXRhdHJhZGVyQWNjb3VudCIsImluY3JlYXNlUmVsaWFiaWxpdHkiLCJlbmFibGVSaXNrTWFuYWdlbWVudEFwaSIsImVuYWJsZU1ldGFTdGF0c0FwaSIsImNyZWF0ZUNvbmZpZ3VyYXRpb25MaW5rIiwidHRsSW5EYXlzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUVB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